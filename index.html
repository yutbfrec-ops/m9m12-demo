<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>M9/M12 èƒ½åŠ›ç›¤é» Betaï¼ˆæ–¹æ¡ˆAï½œå¤šä¸»é¡Œé¡Œåº«ï½œå–®æª” Demoï¼‰</title>
  <style>
    :root{
      --bg:#F6F8FB;
      --card:#FFFFFF;
      --ink:#0B1220;
      --muted:#667085;
      --line:#E6EAF2;
      --primary:#2F6FED;
      --primary-2:#1F56C5;
      --accent:#F59E0B;
      --good:#16A34A;
      --shadow: 0 12px 35px rgba(14,30,66,.14);
      --radius: 18px;
      --radius2: 14px;
      --font: system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans TC", "PingFang TC", "Microsoft JhengHei", Arial, sans-serif;
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: var(--font);
      color:var(--ink);
      background: radial-gradient(1100px 600px at 20% -20%, rgba(47,111,237,.12), transparent 60%),
                  radial-gradient(900px 500px at 95% 20%, rgba(245,158,11,.10), transparent 55%),
                  var(--bg);
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:24px;
    }

    /* "Phone" mock container */
    .phone{
      width:min(420px, 96vw);
      background:#0E1B2D;
      border-radius:34px;
      padding:14px;
      box-shadow: 0 18px 60px rgba(0,0,0,.20);
    }
    .bezel{
      background: linear-gradient(180deg, #0B1626, #0C1A2E);
      border-radius:28px;
      padding:10px;
      position:relative;
    }
    .screen{
      background: linear-gradient(180deg, #FFFFFF, #F7FAFF);
      border-radius:22px;
      min-height:740px;
      overflow:hidden;
      position:relative;
    }
    .statusbar{
      height:44px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding:0 16px;
      color:#111827;
      font-weight:600;
      font-size:13px;
      opacity:.9;
    }
    .status-icons{
      display:flex;
      gap:10px;
      align-items:center;
      font-weight:700;
    }
    .pill{
      width:120px;
      height:5px;
      background:#0B1626;
      opacity:.15;
      border-radius:999px;
      margin:10px auto 2px;
    }

    /* Shared layout */
    .wrap{
      padding:18px 16px 20px;
    }
    h1{
      margin:6px 0 12px;
      font-size:26px;
      line-height:1.15;
      letter-spacing:-0.4px;
    }
    p{
      margin:0 0 14px;
      color:var(--muted);
      line-height:1.5;
      font-size:14px;
    }

    .card{
      background:var(--card);
      border:1px solid var(--line);
      border-radius:var(--radius);
      padding:14px;
      box-shadow: 0 10px 30px rgba(15, 23, 42, .05);
    }

    .row{display:flex; gap:12px; align-items:center;}
    .col{display:flex; flex-direction:column; gap:10px;}
    .spacer{height:10px;}

    .input{
      width:100%;
      border:1px solid var(--line);
      border-radius:14px;
      padding:14px 14px;
      font-size:15px;
      outline:none;
      background:#fff;
    }
    .input:focus{border-color: rgba(47,111,237,.5); box-shadow: 0 0 0 4px rgba(47,111,237,.10);}

    .btn{
      width:100%;
      border:0;
      border-radius:16px;
      padding:14px 16px;
      font-size:16px;
      font-weight:700;
      cursor:pointer;
      background:var(--primary);
      color:#fff;
      box-shadow: 0 12px 28px rgba(47,111,237,.25);
    }
    .btn:hover{background:var(--primary-2);}
    .btn.secondary{
      background:#EEF3FF;
      color:#1F3B7A;
      box-shadow:none;
      border:1px solid #DCE6FF;
    }
    .btn.ghost{
      background:transparent;
      color:#1F3B7A;
      border:1px solid #DCE6FF;
      box-shadow:none;
    }

    .linkrow{
      display:flex; align-items:center; justify-content:space-between;
      color:#1F3B7A;
      font-weight:700;
      font-size:14px;
      padding:12px 6px;
      cursor:pointer;
      user-select:none;
    }
    .linkrow span{color:#1F3B7A}
    .chev{opacity:.7}

    .chips{display:flex; gap:10px; flex-wrap:wrap;}
    .chip{
      padding:10px 12px;
      border-radius:999px;
      border:1px solid #DCE2EE;
      background:#fff;
      cursor:pointer;
      font-size:13px;
      font-weight:700;
      color:#334155;
      user-select:none;
      transition:.15s;
    }
    .chip.active{
      border-color: rgba(47,111,237,.55);
      background: rgba(47,111,237,.10);
      color:#1F56C5;
    }

    /* Top nav */
    .topnav{
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding:0 16px 6px;
    }
    .back{
      display:flex; align-items:center; gap:8px;
      font-weight:800; color:#1F3B7A;
      cursor:pointer; user-select:none;
    }
    .back svg{opacity:.8}
    .step{
      font-size:13px; color:#64748B; font-weight:700;
    }

    /* Progress bar */
    .progress{
      height:8px;
      background:#EEF2FF;
      border-radius:999px;
      overflow:hidden;
      border:1px solid #E1E7FF;
    }
    .bar{
      height:100%;
      width:0%;
      background: linear-gradient(90deg, var(--primary), #60A5FA);
      border-radius:999px;
      transition: width .25s ease;
    }

    /* Illustration */
    .illus{
      display:flex;
      align-items:center;
      justify-content:center;
      padding:10px 0 2px;
    }
    .illus svg{
      width: 240px;
      max-width: 92%;
      height:auto;
    }

    /* Question options */
    .option{
      width:100%;
      text-align:left;
      padding:13px 12px;
      border-radius:16px;
      border:1px solid #DCE2EE;
      background:#fff;
      cursor:pointer;
      font-weight:750;
      color:#0F172A;
      line-height:1.35;
      transition:.12s;
    }
    .option:hover{border-color: rgba(47,111,237,.45); box-shadow: 0 0 0 4px rgba(47,111,237,.08);}
    .option.selected{
      border-color: rgba(47,111,237,.55);
      background: rgba(47,111,237,.08);
    }
    .hint{
      font-size:12px;
      color:#64748B;
      display:flex;
      gap:8px;
      align-items:flex-start;
      padding:10px 12px;
      background:#F7FAFF;
      border:1px solid #E6EEFF;
      border-radius:16px;
    }

    /* Loading */
    .loadingSteps{
      display:flex; flex-direction:column; gap:14px;
    }
    .stepRow{
      display:flex; flex-direction:column; gap:8px;
    }
    .stepTitle{
      font-weight:850; color:#1F3B7A;
    }
    .spinner{
      width:26px; height:26px;
      border-radius:999px;
      border:3px solid #DCE6FF;
      border-top-color: var(--primary);
      animation: spin 1s linear infinite;
      margin: 14px auto 0;
    }
    @keyframes spin {to{transform:rotate(360deg)}}

    /* Results */
    .stars{display:flex; gap:4px; align-items:center;}
    .star{
      width:18px; height:18px;
      fill:#E5E7EB;
    }
    .star.on{fill: var(--accent);}
    .kpi{
      display:flex; align-items:flex-end; gap:10px;
    }
    .bigNum{font-size:56px; font-weight:950; line-height:1;}
    .bigLabel{font-weight:900; color:#1F3B7A; margin-bottom:6px;}
    .dimRow{
      display:flex; align-items:center; justify-content:space-between;
      gap:10px; padding:8px 0;
    }
    .dimName{font-weight:850; color:#334155; font-size:14px;}
    .dimStars .star{width:14px;height:14px}
    .badge{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:10px 12px;
      border-radius:999px;
      background: rgba(22,163,74,.10);
      color:#14532D;
      font-weight:850;
      border:1px solid rgba(22,163,74,.20);
      font-size:13px;
    }

    .ctaRow{display:flex; gap:10px;}
    .ctaRow .btn{flex:1}

    /* View switching */
    .view{
      display:none;
      animation: fadeUp .18s ease;
    }
    .view.active{display:block;}
    @keyframes fadeUp{
      from{opacity:0; transform: translateY(6px);}
      to{opacity:1; transform: translateY(0);}
    }

    /* Bottom safe area */
    .homebar{
      position:absolute;
      left:0; right:0; bottom:0;
      height:26px;
      display:flex; align-items:center; justify-content:center;
      background: linear-gradient(180deg, transparent, rgba(255,255,255,.96));
    }
    .homebar:before{
      content:"";
      width:140px; height:5px;
      border-radius:999px;
      background:#0B1626;
      opacity:.14;
    }

    /* Small helper */
    .small{font-size:12px; color:#64748B; line-height:1.45;}
    .muted{color:#64748B;}
    .divider{height:1px; background:var(--line); margin:12px 0;}
  </style>
</head>
<body>
  <div class="phone">
    <div class="bezel">
      <div class="screen">
        <div class="statusbar">
          <div id="clock">9:41</div>
          <div class="status-icons">
            <span>â–®â–®â–®</span><span>âŒ</span><span>ğŸ”‹</span>
          </div>
        </div>
        <div class="pill"></div>

        <!-- S1: Target input -->
        <section id="v-s1" class="view active">
          <div class="wrap">
            <h1>ä½ æƒ³ç›¤é»å“ªå€‹<br/>è·å ´èƒ½åŠ›ï¼Ÿ</h1>
            <p>åƒåšã€Œæ—…éŠæ›¸ã€ä¸€æ¨£ï¼Œ3â€“5 åˆ†é˜å®Œæˆç›¤é»ï¼Œç«‹å³æ‹¿åˆ°æ˜Ÿç­‰èˆ‡å»ºè­°ã€‚</p>

            <input id="targetInput" class="input" placeholder="e.g. æºé€šå”ä½œ / åŸ·è¡Œæ¨é€² / å•é¡Œè§£æ±º / é ˜å°å¸¶äºº" />

            <div class="spacer"></div>

            <div class="chips" id="presetChips"></div>

            <div class="spacer"></div>

            <div id="advRow" class="linkrow">
              <span>é€²éšè¨­å®š</span>
              <span class="chev">â€º</span>
            </div>

            <div class="illus" aria-hidden="true">
              <svg viewBox="0 0 520 300" xmlns="http://www.w3.org/2000/svg">
                <defs>
                  <linearGradient id="g1" x1="0" x2="1">
                    <stop offset="0" stop-color="#2F6FED" stop-opacity=".18"/>
                    <stop offset="1" stop-color="#60A5FA" stop-opacity=".06"/>
                  </linearGradient>
                </defs>
                <circle cx="250" cy="135" r="120" fill="url(#g1)"/>
                <rect x="145" y="155" width="230" height="110" rx="22" fill="#FFFFFF" stroke="#DCE2EE"/>
                <rect x="175" y="180" width="170" height="14" rx="7" fill="#E6EEFF"/>
                <rect x="175" y="205" width="130" height="14" rx="7" fill="#E6EEFF"/>
                <rect x="175" y="230" width="90" height="14" rx="7" fill="#E6EEFF"/>
                <circle cx="110" cy="220" r="44" fill="#FFF7ED" stroke="#FED7AA"/>
                <path d="M98 218c18-4 22-19 22-19 8 14 5 31-10 38-13 6-27 0-32-9" fill="none" stroke="#F59E0B" stroke-width="6" stroke-linecap="round"/>
                <path d="M430 98c0 18-14 32-32 32s-32-14-32-32 14-32 32-32 32 14 32 32Z" fill="#EEF3FF" stroke="#DCE6FF"/>
                <path d="M387 98h22" stroke="#2F6FED" stroke-width="6" stroke-linecap="round"/>
                <path d="M398 87v22" stroke="#2F6FED" stroke-width="6" stroke-linecap="round"/>
              </svg>
            </div>

            <button id="btnToOverview" class="btn">ä¸‹ä¸€æ­¥</button>

            <div class="spacer"></div>
            <div class="small">
              <strong>æç¤ºï¼š</strong>é€™æ˜¯ Beta Demoï¼ˆç„¡å¾Œç«¯ï¼‰ã€‚è³‡æ–™åªå­˜åœ¨ä½ æœ¬æ©Ÿç€è¦½å™¨ï¼ˆå¯æ¸…é™¤ï¼‰ã€‚<br/>
              <span class="muted">æ¯å€‹ä¸»é¡Œæœƒå„è‡ªä¿å­˜è‰ç¨¿ï¼ˆäº’ä¸è¦†è“‹ï¼‰ã€‚</span>
            </div>
          </div>
        </section>

        <!-- S2: Advanced settings -->
        <section id="v-s2" class="view">
          <div class="topnav">
            <div class="back" data-back="v-s1">
              <svg width="18" height="18" viewBox="0 0 24 24"><path fill="currentColor" d="M15.5 19 8.5 12l7-7"/></svg>
              è¿”å›
            </div>
            <div class="step">é€²éšè¨­å®š</div>
            <div style="width:48px"></div>
          </div>

          <div class="wrap">
            <h1>å ±å‘Šæƒ³åä»€éº¼<br/>é¢¨æ ¼ï¼Ÿ</h1>
            <p>ä½ å¯ä»¥å…ˆç”¨é è¨­ï¼Œä¹‹å¾Œå†èª¿æ•´ï¼ˆä¸å½±éŸ¿å®Œæˆï¼‰ã€‚</p>

            <div class="card">
              <div class="col">
                <div>
                  <div class="muted" style="font-weight:800; font-size:13px; margin-bottom:8px;">å ±å‘Šèªæ°£</div>
                  <div class="chips">
                    <div class="chip pref" data-key="tone" data-val="direct">ç›´æ¥æ¸…æ¥š</div>
                    <div class="chip pref" data-key="tone" data-val="gentle">æº«å’Œå¼•å°</div>
                  </div>
                </div>

                <div class="divider"></div>

                <div>
                  <div class="muted" style="font-weight:800; font-size:13px; margin-bottom:8px;">å»ºè­°åå¥½</div>
                  <div class="chips">
                    <div class="chip pref" data-key="focus" data-val="strategy">åç­–ç•¥</div>
                    <div class="chip pref" data-key="focus" data-val="action">åè¡Œå‹•</div>
                  </div>
                </div>

                <div class="divider"></div>

                <div>
                  <div class="muted" style="font-weight:800; font-size:13px; margin-bottom:8px;">ä½¿ç”¨æƒ…å¢ƒ</div>
                  <div class="chips">
                    <div class="chip pref" data-key="role" data-val="individual">å€‹äººç›¤é»</div>
                    <div class="chip pref" data-key="role" data-val="manager">ä¸»ç®¡è¦–è§’</div>
                    <div class="chip pref" data-key="role" data-val="hr">HR/é¡§å•</div>
                  </div>
                </div>

              </div>
            </div>

            <div class="spacer"></div>
            <button id="btnToOverview2" class="btn">å®Œæˆè¨­å®šï¼Œé–‹å§‹</button>

            <div class="spacer"></div>
            <div class="small">
              <strong>éš±ç§ï¼š</strong>ä¸éœ€è¦å§“åã€‚æ­¤ Demo ä¸ä¸Šå‚³è³‡æ–™ã€‚
            </div>
          </div>
        </section>

        <!-- S3: Overview -->
        <section id="v-s3" class="view">
          <div class="topnav">
            <div class="back" data-back="v-s1">
              <svg width="18" height="18" viewBox="0 0 24 24"><path fill="currentColor" d="M15.5 19 8.5 12l7-7"/></svg>
              è¿”å›
            </div>
            <div class="step" id="overviewStep">æ¦‚è¦½</div>
            <div style="width:48px"></div>
          </div>

          <div class="wrap">
            <h1 id="overviewTitle">èƒ½åŠ›ç›¤é»æ¦‚è¦½</h1>
            <p>ä½ å°‡å›ç­”å¹¾å€‹æƒ…å¢ƒé¡Œã€‚é¸ã€Œä½ å¹³å¸¸çš„åšæ³•ã€å³å¯ã€‚</p>

            <div class="card">
              <div class="col">
                <div class="row" style="justify-content:space-between">
                  <div>
                    <div class="muted" style="font-weight:850; font-size:13px;">ä¸»é¡Œ</div>
                    <div id="summaryTarget" style="font-weight:950; font-size:18px; margin-top:2px;">â€”</div>
                    <div class="small" id="summaryHint" style="margin-top:6px;">â€”</div>
                  </div>
                  <div class="badge">ç´„ 3â€“5 åˆ†é˜</div>
                </div>

                <div class="divider"></div>

                <div class="row" style="justify-content:space-between">
                  <div class="muted" style="font-weight:850;">é¡Œæ•¸</div>
                  <div style="font-weight:950;" id="summaryQCount">â€”</div>
                </div>
                <div class="row" style="justify-content:space-between">
                  <div class="muted" style="font-weight:850;">æ¨¡å¼</div>
                  <div style="font-weight:950;" id="summaryPrefs">â€”</div>
                </div>

                <div class="divider"></div>
                <div class="small">
                  <strong>æé†’ï¼š</strong>é€™ä»½çµæœç”¨æ–¼ã€Œæ±ºç­–åƒè€ƒã€ï¼Œè«‹çµåˆä½ å¯¦éš›å·¥ä½œæƒ…å¢ƒåˆ¤æ–·ã€‚
                </div>
              </div>
            </div>

            <div class="illus" aria-hidden="true">
              <svg viewBox="0 0 520 300" xmlns="http://www.w3.org/2000/svg">
                <circle cx="270" cy="135" r="120" fill="rgba(47,111,237,.12)"/>
                <path d="M165 210c18-30 50-52 88-52 46 0 85 33 95 78" fill="none" stroke="#2F6FED" stroke-width="8" stroke-linecap="round"/>
                <path d="M210 210c10-18 26-30 45-30 23 0 42 16 48 38" fill="none" stroke="#60A5FA" stroke-width="8" stroke-linecap="round"/>
                <rect x="120" y="214" width="280" height="56" rx="18" fill="#FFFFFF" stroke="#DCE2EE"/>
                <rect x="150" y="235" width="180" height="12" rx="6" fill="#E6EEFF"/>
                <circle cx="385" cy="244" r="14" fill="#FDE68A"/>
              </svg>
            </div>

            <button id="btnStart" class="btn">é–‹å§‹ç›¤é»</button>
            <div class="spacer"></div>
            <button id="btnToPrefs" class="btn secondary">èª¿æ•´åå¥½</button>
          </div>
        </section>

        <!-- S4: Question -->
        <section id="v-s4" class="view">
          <div class="topnav">
            <div class="back" id="btnBackQ">
              <svg width="18" height="18" viewBox="0 0 24 24"><path fill="currentColor" d="M15.5 19 8.5 12l7-7"/></svg>
              è¿”å›
            </div>
            <div class="step" id="qStep">ç¬¬ 1 é¡Œ</div>
            <div style="width:48px"></div>
          </div>

          <div class="wrap">
            <div class="progress"><div class="bar" id="qBar"></div></div>
            <div class="spacer"></div>

            <h1 id="qTitle">â€”</h1>
            <p id="qDesc">â€”</p>

            <div class="col" id="options"></div>

            <div class="spacer"></div>
            <div class="hint">
              <div style="font-weight:950;">ğŸ’¡</div>
              <div>
                é¸ã€Œæœ€æ¥è¿‘ä½ å¹³å¸¸çš„åšæ³•ã€ã€‚å¦‚æœä½ çœŸçš„ä¸ç¢ºå®šï¼Œå¯ä»¥é¸ã€Œä¸ç¢ºå®šã€ï¼Œä½†çµæœå¯ä¿¡åº¦æœƒé™ä½ã€‚
              </div>
            </div>

            <div class="spacer"></div>
            <button id="btnUnsure" class="btn ghost">ä¸ç¢ºå®šï¼ˆè·³éæ­¤é¡Œï¼‰</button>
          </div>
        </section>

        <!-- S5: Confirm -->
        <section id="v-s5" class="view">
          <div class="topnav">
            <div class="back" data-back="v-s4">
              <svg width="18" height="18" viewBox="0 0 24 24"><path fill="currentColor" d="M15.5 19 8.5 12l7-7"/></svg>
              è¿”å›
            </div>
            <div class="step">å®Œæˆ</div>
            <div style="width:48px"></div>
          </div>

          <div class="wrap">
            <h1>å·²å®Œæˆå›ç­”ï¼Œ<br/>è¦ç”Ÿæˆçµæœå—ï¼Ÿ</h1>
            <p>ä½ å¯ä»¥å›åˆ°ä¸Šä¸€é¡Œä¿®æ”¹ã€‚ä¹Ÿå¯ä»¥ç›´æ¥ç”Ÿæˆæ˜Ÿç­‰èˆ‡æ´å¯Ÿã€‚</p>

            <div class="card">
              <div class="row" style="justify-content:space-between">
                <div class="muted" style="font-weight:850;">å·²å›ç­”</div>
                <div style="font-weight:950;" id="answeredCount">â€”</div>
              </div>
              <div class="row" style="justify-content:space-between; margin-top:10px;">
                <div class="muted" style="font-weight:850;">ä¸»é¡Œ</div>
                <div style="font-weight:950;" id="confirmTarget">â€”</div>
              </div>
            </div>

            <div class="spacer"></div>
            <button id="btnGenerate" class="btn">ç”Ÿæˆæˆ‘çš„çµæœ</button>
            <div class="spacer"></div>
            <button id="btnRestart" class="btn secondary">é‡æ–°é–‹å§‹ï¼ˆæœ¬ä¸»é¡Œï¼‰</button>

            <div class="spacer"></div>
            <div class="small">
              ç”Ÿæˆåˆ†å…©æ­¥ï¼šå…ˆè¨ˆç®—æ˜Ÿç­‰ â†’ å†ç”Ÿæˆæ´å¯Ÿï¼ˆæ›´åƒå•†æ¥­å·¥å…·çš„å¯ä¿¡æµç¨‹ï¼‰ã€‚
            </div>
          </div>
        </section>

        <!-- S6: Loading -->
        <section id="v-s6" class="view">
          <div class="topnav">
            <div class="back" id="btnCancelLoading">
              <svg width="18" height="18" viewBox="0 0 24 24"><path fill="currentColor" d="M15.5 19 8.5 12l7-7"/></svg>
              è¿”å›
            </div>
            <div class="step">ç”Ÿæˆä¸­</div>
            <div style="width:48px"></div>
          </div>

          <div class="wrap">
            <h1 id="loadingTitle">æ­£åœ¨ç”Ÿæˆå ±å‘Šâ€¦</h1>
            <p id="loadingDesc">è«‹ç¨å€™ï¼Œé€™åªæ˜¯ä¸€å€‹ Demo çš„æ¨¡æ“¬æµç¨‹ã€‚</p>

            <div class="card">
              <div class="loadingSteps">
                <div class="stepRow">
                  <div class="stepTitle" id="ls1">Step 1. æ­£åœ¨è¨ˆç®—æ˜Ÿç­‰â€¦</div>
                  <div class="progress"><div class="bar" id="lsBar1"></div></div>
                </div>
                <div class="stepRow">
                  <div class="stepTitle" id="ls2">Step 2. æ­£åœ¨ç”Ÿæˆæ´å¯Ÿèˆ‡å»ºè­°â€¦</div>
                  <div class="progress"><div class="bar" id="lsBar2"></div></div>
                </div>
              </div>
              <div class="spinner"></div>
              <div class="small" style="margin-top:12px;">
                <strong>æç¤ºï¼š</strong>çµæœåƒ…ä¾›æ±ºç­–åƒè€ƒï¼Œä¸åšè‡ªå‹•åŸ·è¡Œï¼ˆDecision Supportï¼‰ã€‚
              </div>
            </div>

            <div class="spacer"></div>
            <button id="btnSkipToResult" class="btn secondary">å¿«é€Ÿè·³åˆ°çµæœï¼ˆDemoï¼‰</button>
          </div>
        </section>

        <!-- S7: Result summary -->
        <section id="v-s7" class="view">
          <div class="topnav">
            <div class="back" data-back="v-s1">
              <svg width="18" height="18" viewBox="0 0 24 24"><path fill="currentColor" d="M15.5 19 8.5 12l7-7"/></svg>
              å›é¦–é 
            </div>
            <div class="step">çµæœæ‘˜è¦</div>
            <div style="width:48px"></div>
          </div>

          <div class="wrap">
            <h1>ä½ çš„çµæœæ‘˜è¦</h1>
            <p>å…ˆçœ‹é‡é»å¡ç‰‡ï¼Œå†æ±ºå®šè¦ä¸è¦å±•é–‹å®Œæ•´ç‰ˆã€‚</p>

            <div class="card">
              <div class="kpi">
                <div class="bigNum" id="overallNum">â€”</div>
                <div style="flex:1">
                  <div class="bigLabel" id="overallLabel">â€”</div>
                  <div class="stars" id="overallStars"></div>
                  <div class="small" id="confidenceLine" style="margin-top:6px;">â€”</div>
                </div>
              </div>

              <div class="divider"></div>
              <div class="col" id="dimList"></div>
            </div>

            <div class="spacer"></div>

            <div class="card">
              <div class="muted" style="font-weight:900; margin-bottom:8px;">ä¸‰å€‹æ´å¯Ÿ</div>
              <div class="col" id="insights"></div>
              <div class="divider"></div>
              <div class="muted" style="font-weight:900; margin-bottom:8px;">ç«‹å³è¡Œå‹•ï¼ˆä»Šå¤©å°±èƒ½åšï¼‰</div>
              <div id="actionNow" style="font-weight:850;"></div>
            </div>

            <div class="spacer"></div>

            <div class="ctaRow">
              <button id="btnFullReport" class="btn">å±•é–‹å®Œæ•´ç‰ˆ</button>
              <button id="btnShare" class="btn secondary">åˆ†äº«æ‘˜è¦</button>
            </div>

            <div class="spacer"></div>
            <button id="btnResetAll" class="btn ghost">æ¸…é™¤è‰ç¨¿/é‡åš</button>

            <div class="spacer"></div>
            <div class="small">
              <strong>å•†æ¥­åŒ–æ›é»ï¼š</strong>å®Œæ•´ç‰ˆå¯åŠ ã€Œ30 å¤©è¡Œå‹•è¨ˆç•«ã€ã€Œåœ˜éšŠå°ç…§ã€ã€Œé¡§å•è¨ªè«‡æç¶±ã€ã€‚
            </div>
          </div>
        </section>

        <!-- S8: Full report (simple) -->
        <section id="v-s8" class="view">
          <div class="topnav">
            <div class="back" data-back="v-s7">
              <svg width="18" height="18" viewBox="0 0 24 24"><path fill="currentColor" d="M15.5 19 8.5 12l7-7"/></svg>
              è¿”å›
            </div>
            <div class="step">å®Œæ•´ç‰ˆ</div>
            <div style="width:48px"></div>
          </div>

          <div class="wrap">
            <h1>å®Œæ•´ç‰ˆå ±å‘Š</h1>
            <p>é€™è£¡å…ˆåšã€Œé–±è®€å™¨ã€é››å½¢ï¼ˆå¯æŠ˜ç–Šç« ç¯€ã€å¯åŠ é¡§å•ç‰ˆå…§å®¹ï¼‰ã€‚</p>

            <div class="card">
              <div style="font-weight:950; font-size:16px;" id="fullTitle">â€”</div>
              <div class="small" style="margin-top:6px;" id="fullMeta">â€”</div>
              <div class="divider"></div>

              <div class="col">
                <div>
                  <div style="font-weight:950;">A. ä½ çš„èƒ½åŠ›è¼ªå»“</div>
                  <div class="small" id="fullA"></div>
                </div>
                <div class="divider"></div>
                <div>
                  <div style="font-weight:950;">B. ä½ æœ€å¸¸é‡åˆ°çš„é¢¨éšªæƒ…å¢ƒ</div>
                  <div class="small" id="fullB"></div>
                </div>
                <div class="divider"></div>
                <div>
                  <div style="font-weight:950;">C. æ”¹å–„ç­–ç•¥ï¼ˆ3 æ¢ï¼‰</div>
                  <div class="small" id="fullC"></div>
                </div>
                <div class="divider"></div>
                <div>
                  <div style="font-weight:950;">D. 30 å¤©è¡Œå‹•è¨ˆç•«ï¼ˆç¤ºä¾‹ï¼‰</div>
                  <div class="small" id="fullD"></div>
                </div>
                <div class="divider"></div>
                <div>
                  <div style="font-weight:950;">E. æ–¹æ³•èˆ‡å¯ä¿¡åº¦ï¼ˆç°¡çŸ­ï¼‰</div>
                  <div class="small" id="fullE"></div>
                </div>
              </div>
            </div>

            <div class="spacer"></div>
            <button class="btn secondary" id="btnBackToSummary">å›æ‘˜è¦é </button>
          </div>
        </section>

        <div class="homebar"></div>
      </div>
    </div>
  </div>

<script>
/** ======================================================
 *  å¤šä¸»é¡Œé¡Œåº«ï¼ˆHard-code, no APIï¼‰
 *  - æ¯å€‹ä¸»é¡Œ 8 é¡Œï¼ˆä½ å¯è‡ªè¡Œæ”¹é¡Œ/æ”¹æ¬Šé‡/å¢åˆªé¡Œï¼‰
 *  - æ¯é¡Œéƒ½æœ‰ dim èˆ‡ options(score 1..5)
 * ====================================================== */
const QUESTION_BANK = {
  "æºé€šå”ä½œ": {
    hint: "èšç„¦ï¼šè¨Šæ¯æ¸…æ¥šã€å…±è­˜å°é½Šã€è·¨éƒ¨é–€æ¨é€²ã€‚",
    questions: [
      {
        id:"C1",
        title:"æƒ…å¢ƒï¼šè·¨éƒ¨é–€å”ä½œå¡ä½",
        desc:"ä½ åœ¨æ¨é€²å°ˆæ¡ˆæ™‚ï¼Œå°æ–¹éƒ¨é–€å›è¦†æ…¢ã€éœ€æ±‚åè¦†ï¼Œé€²åº¦é–‹å§‹è½å¾Œã€‚ä½ é€šå¸¸æœƒæ€éº¼åšï¼Ÿ",
        dim:"å”ä½œæ¨é€²",
        options:[
          {text:"å…ˆé‡æ¸…å½¼æ­¤ç›®æ¨™èˆ‡è²¬ä»»åˆ†å·¥ï¼Œç´„å®šæœ€å°å¯äº¤ä»˜ç‰ˆæœ¬ï¼ˆMVPï¼‰", score:5},
          {text:"æŠŠå•é¡Œå…ˆè¨˜éŒ„èµ·ä¾†ï¼Œç­‰ä¸‹æ¬¡ä¾‹æœƒå†ä¸€èµ·è¨è«–", score:3},
          {text:"ç›´æ¥è¦æ±‚å°æ–¹æŒ‰ä½ åŸæœ¬è¨ˆç•«åšï¼Œé¿å…æ›´å‹•é€ æˆæˆæœ¬", score:2},
          {text:"å…ˆè‡ªå·±åšå®Œï¼Œå°æ–¹é…åˆå³å¯", score:1}
        ]
      },
      {
        id:"C2",
        title:"æƒ…å¢ƒï¼šè¨Šæ¯è¢«èª¤è§£é€ æˆé‡å·¥",
        desc:"ä½ äº¤è¾¦çš„è¨Šæ¯è¢«åŒäº‹ç†è§£æˆå¦ä¸€ä»¶äº‹ï¼Œå°è‡´é‡å·¥ã€‚ä½ æœƒæ€éº¼æ”¹å–„ï¼Ÿ",
        dim:"æºé€šæ¸…æ™°",
        options:[
          {text:"ç”¨ä¸€å¥è©±å¯«æ¸…æ¥šã€Œç›®çš„/è¼¸å‡º/æˆªæ­¢æ™‚é–“ã€ï¼Œå¿…è¦æ™‚é™„ç¯„ä¾‹", score:5},
          {text:"æ”¹ç”¨èªéŸ³/é›»è©±è¬›ï¼Œæ–‡å­—å¤ªå®¹æ˜“èª¤æœƒ", score:3},
          {text:"è¦ºå¾—å°æ–¹æ‡‰è©²è‡ªå·±å•æ¸…æ¥š", score:2},
          {text:"é¿å…å†äº¤è¾¦ï¼Œè‡ªå·±åšæ¯”è¼ƒå¿«", score:1}
        ]
      },
      {
        id:"C3",
        title:"æƒ…å¢ƒï¼šæœƒè­°çµè«–å„èªªå„è©±",
        desc:"æœƒè­°çµæŸå¾Œå¤§å®¶åšæ³•ä¸ä¸€è‡´ï¼Œé¡¯ç¤ºå…±è­˜æ²’æœ‰è½åœ°ã€‚ä½ æœƒï¼Ÿ",
        dim:"å…±è­˜å°é½Š",
        options:[
          {text:"æœƒå¾Œ 5 åˆ†é˜æ•´ç†æ±ºè­°ï¼šèª°/åšä»€éº¼/ä½•æ™‚ï¼Œä¸¦è«‹å„æ–¹å›è¦†ç¢ºèª", score:5},
          {text:"ç­‰åˆ°æœ‰äººåšéŒ¯å†æé†’ä¿®æ­£", score:3},
          {text:"è¦ºå¾—å¤§å®¶æ‡‰è©²éƒ½æ‡‚ï¼Œä¸éœ€è¦å¯«", score:2},
          {text:"çœ‹èª°å…ˆåšå°±è·Ÿèª°çš„åšæ³•", score:1}
        ]
      },
      {
        id:"C4",
        title:"æƒ…å¢ƒï¼šå°æ–¹ä¸€ç›´ä¸Ÿå›ä¾†è¦ä½ æ”¹",
        desc:"åˆä½œæ–¹ä¸€ç›´èªªã€Œä¸å¤ªå°ã€ä½†èªªä¸æ¸…æ¥šã€‚ä½ æœƒæ€éº¼å•ï¼Ÿ",
        dim:"æå•æ¾„æ¸…",
        options:[
          {text:"å•æ¸…æ¥šè©•ä¼°æ¨™æº–ï¼šä»€éº¼ç®—å¥½/ä¸å¥½ï¼Ÿçµ¦ 2â€“3 å€‹é¸é …è®“å°æ–¹é¸", score:5},
          {text:"è«‹å°æ–¹ç”¨èªéŸ³è¬›ä¸€é", score:3},
          {text:"å†çŒœä¸€æ¬¡æ”¹æ”¹çœ‹", score:2},
          {text:"è¦ºå¾—å°æ–¹å¾ˆé›£æï¼Œå…ˆæ”¾è‘—", score:1}
        ]
      },
      {
        id:"C5",
        title:"æƒ…å¢ƒï¼šä½ è¦å½±éŸ¿ä½†æ²’æ¬Šé™",
        desc:"ä½ å¸Œæœ›æŸä»¶äº‹è¢«å„ªå…ˆè™•ç†ï¼Œä½†ä½ æ²’æœ‰ç›´æ¥æ¬Šé™ã€‚ä½ æœƒæ€éº¼æ¨å‹•ï¼Ÿ",
        dim:"å½±éŸ¿åŠ›",
        options:[
          {text:"æ•´ç†åˆ©å®³é—œä¿‚äººé—œæ³¨é»ï¼Œç”¨å°æ–¹åœ¨æ„çš„æŒ‡æ¨™/é¢¨éšªå»å°é½Š", score:5},
          {text:"è«‹ä¸»ç®¡å¹«å¿™æ–½å£“", score:3},
          {text:"ç™¼æ›´å¤šè¨Šæ¯æé†’ï¼Œç¸½æœƒæœ‰äººå›", score:2},
          {text:"ç®—äº†ï¼Œåæ­£ä¸æ˜¯ä½ è² è²¬", score:1}
        ]
      },
      {
        id:"C6",
        title:"æƒ…å¢ƒï¼šè¡çªå‡æº«",
        desc:"æœƒè­°ä¸­åŒäº‹èªæ°£è®Šå°–éŠ³ï¼Œé–‹å§‹å¦å®šä½ çš„åšæ³•ã€‚ä½ é€šå¸¸æœƒï¼Ÿ",
        dim:"è¡çªè™•ç†",
        options:[
          {text:"å…ˆæŠŠçˆ­é»æ‹‰å›ã€å…±åŒç›®æ¨™ã€ï¼Œå†æ‹†æˆå¯é©—è­‰å•é¡Œé€ä¸€è™•ç†", score:5},
          {text:"å…ˆæ²‰é»˜ï¼Œç­‰å°æ–¹å†·éœå¾Œå†èŠ", score:3},
          {text:"ç«‹åˆ»åé§ï¼Œé¿å…è¢«èª¤è§£æˆä½ éŒ¯äº†", score:2},
          {text:"ç›´æ¥çµæŸè¨è«–ï¼Œä¹‹å¾Œå†èªª", score:2}
        ]
      },
      {
        id:"C7",
        title:"æƒ…å¢ƒï¼šå›é¥‹å¾ˆé›£è½ä½†å¯èƒ½æ˜¯çœŸçš„",
        desc:"ä½ æ”¶åˆ°ä¸€æ®µç›´æ¥çš„æ‰¹è©•å›é¥‹ï¼Œä½ æœƒæ€éº¼è™•ç†ï¼Ÿ",
        dim:"å›é¥‹å¸æ”¶",
        options:[
          {text:"å…ˆç¢ºèªäº‹å¯¦èˆ‡ä¾‹å­ï¼Œå†å•ã€Œä½ å¸Œæœ›æˆ‘ä¸‹æ¬¡æ€éº¼åšï¼Ÿã€", score:5},
          {text:"å…ˆæ¥å—ï¼Œä¹‹å¾Œå†æ…¢æ…¢æ¶ˆåŒ–", score:3},
          {text:"å…ˆè§£é‡‹è‡ªå·±ä¸æ˜¯é‚£å€‹æ„æ€", score:2},
          {text:"è¦ºå¾—å°æ–¹é‡å°ä½ ï¼Œä¸ç†æœƒ", score:1}
        ]
      },
      {
        id:"C8",
        title:"æƒ…å¢ƒï¼šå”ä½œçš„ç¯€å¥è¢«æ‰“äº‚",
        desc:"å°æ–¹å¸¸è‡¨æ™‚æ”¹éœ€æ±‚ï¼Œå½±éŸ¿ä½ äº¤ä»˜ã€‚ä½ æœƒæ€éº¼è¨­è¦å‰‡ï¼Ÿ",
        dim:"å”ä½œè¦å‰‡",
        options:[
          {text:"è¨‚è®Šæ›´æµç¨‹ï¼šæˆªæ­¢é»ã€å½±éŸ¿è©•ä¼°ã€èª°æ±ºç­–ï¼Œè®“æ”¹å‹•æœ‰æˆæœ¬èˆ‡ç¯€å¥", score:5},
          {text:"å…ˆé…åˆï¼Œç­‰ç´¯ç©åˆ°å¾ˆå¤šå†èªª", score:3},
          {text:"ç›´æ¥æ‹’çµ•å¾ŒçºŒè®Šæ›´", score:2},
          {text:"æ”¾æ£„æºé€šï¼Œè‡ªå·±æƒ³è¾¦æ³•è™•ç†", score:1}
        ]
      }
    ]
  },

  "åŸ·è¡Œæ¨é€²": {
    hint: "èšç„¦ï¼šæ‹†è§£ç›®æ¨™ã€æ§ç¯€å¥ã€äº¤ä»˜èˆ‡è¿­ä»£ã€‚",
    questions: [
      {
        id:"E1",
        title:"æƒ…å¢ƒï¼šè‡¨æ™‚æ’å–®å¹²æ“¾ç¯€å¥",
        desc:"ä¸»ç®¡è‡¨æ™‚è¦ä½ æ’ä¸€å€‹æ€¥ä»¶ï¼Œä½†ä½ åŸæœ¬æ­£åœ¨åšæ›´é‡è¦çš„ä»»å‹™ã€‚ä½ æœƒï¼Ÿ",
        dim:"å„ªå…ˆé †åº",
        options:[
          {text:"ç¢ºèªæ€¥ä»¶åƒ¹å€¼èˆ‡æˆªæ­¢æ™‚é–“ï¼Œæå‡ºèª¿æ•´æ¸…å–®è«‹ä¸»ç®¡æ±ºå®šå–æ¨", score:5},
          {text:"å…ˆæŠŠæ€¥ä»¶åšå®Œï¼ŒåŸæœ¬çš„äº‹ä¹‹å¾Œå†è£œ", score:3},
          {text:"å…ˆæ‹–è‘—ä¸åšï¼Œç­‰ä¸»ç®¡å†æé†’", score:2},
          {text:"ç›´æ¥æ‹’çµ•ï¼Œå› ç‚ºä½ æ‰‹ä¸Šå·²æœ‰å®‰æ’", score:2}
        ]
      },
      {
        id:"E2",
        title:"æƒ…å¢ƒï¼šä»»å‹™å¤ªå¤§ä¸çŸ¥é“å¾å“ªé–‹å§‹",
        desc:"ä½ æ¥åˆ°ä¸€å€‹æ¨¡ç³Šçš„ä»»å‹™ï¼šã€æŠŠé€™ä»¶äº‹åšèµ·ä¾†ã€ã€‚ä½ æœƒå…ˆåšï¼Ÿ",
        dim:"æ‹†è§£è¦åŠƒ",
        options:[
          {text:"å…ˆå®šç¾©æˆåŠŸæ¨™æº–ï¼Œæ‹†æˆé‡Œç¨‹ç¢‘èˆ‡æœ€å°å¯äº¤ä»˜ç‰ˆæœ¬ï¼ˆMVPï¼‰", score:5},
          {text:"å…ˆå¾æœ€å®¹æ˜“çš„éƒ¨åˆ†åšèµ·ï¼Œé‚Šåšé‚Šçœ‹", score:3},
          {text:"ç­‰æ›´å¤šè³‡è¨Šå†é–‹å§‹", score:2},
          {text:"ç›´æ¥åšå®Œæ•´ç‰ˆæœ¬ï¼Œé¿å…é‡å·¥", score:2}
        ]
      },
      {
        id:"E3",
        title:"æƒ…å¢ƒï¼šä½ éœ€è¦åŒæ™‚å…¼é¡§é€Ÿåº¦èˆ‡å“è³ª",
        desc:"è‹¥è¦æ›´å¿«äº¤ä»˜ï¼Œä½ å¯èƒ½è¦çŠ§ç‰²ä¸€äº›æª¢æŸ¥ï¼›ä½†ä¸æª¢æŸ¥æœƒæœ‰é¢¨éšªã€‚ä½ æœƒï¼Ÿ",
        dim:"äº¤ä»˜ç­–ç•¥",
        options:[
          {text:"å…ˆäº¤ä»˜å¯ç”¨ç‰ˆæœ¬ + æ˜ç¢ºåˆ—å‡ºé¢¨éšªèˆ‡è£œé½Šæ™‚é–“é»ï¼ˆåˆ†éšæ®µäº¤ä»˜ï¼‰", score:5},
          {text:"å…ˆäº¤å‡ºå»å†èªªï¼Œä¹‹å¾Œå¯ä»¥ä¿®", score:2},
          {text:"å …æŒåšåˆ°å®Œç¾å†äº¤ï¼Œå»¶é²ä¹Ÿæ²’é—œä¿‚", score:3},
          {text:"çœ‹é‹æ°£ï¼Œè¦ºå¾—æ‡‰è©²ä¸æœƒå‡ºäº‹", score:1}
        ]
      },
      {
        id:"E4",
        title:"æƒ…å¢ƒï¼šé€²åº¦è½å¾Œä½†åŸå› å¾ˆå¤š",
        desc:"ä½ ç™¼ç¾è½å¾Œï¼ŒåŸå› çœ‹èµ·ä¾†å¾ˆå¤šã€‚ä½ æœƒæ€éº¼è™•ç†ï¼Ÿ",
        dim:"ç¯€å¥æ§åˆ¶",
        options:[
          {text:"å…ˆæŠ“æœ€å¤§ç“¶é ¸èˆ‡å¯æ§å› ç´ ï¼Œè¨‚ä¸€å€‹ã€æœ¬é€±å¿…é”ã€æœ€å°ç›®æ¨™", score:5},
          {text:"æŠŠæ‰€æœ‰äº‹æƒ…éƒ½åŠ ç­è£œå›ä¾†", score:3},
          {text:"å…ˆæŠŠå•é¡Œåˆ—å‡ºä¾†ï¼Œç­‰ä¸‹é€±å†è™•ç†", score:2},
          {text:"è¦ºå¾—å·²ç¶“ä¾†ä¸åŠï¼Œä¹¾è„†æ”¾æ£„", score:1}
        ]
      },
      {
        id:"E5",
        title:"æƒ…å¢ƒï¼šä½ éœ€è¦è¿½è¹¤å¤šå€‹å¾…è¾¦",
        desc:"ä½ åŒæ™‚æœ‰å¾ˆå¤šå¾…è¾¦ï¼Œå®¹æ˜“æ¼æ‰ã€‚ä½ æœƒç”¨ä»€éº¼æ–¹æ³•ï¼Ÿ",
        dim:"ä»»å‹™ç®¡ç†",
        options:[
          {text:"ç”¨ä¸€å€‹ç³»çµ±ï¼ˆçœ‹æ¿/æ¸…å–®ï¼‰ç®¡ç†ï¼šç‹€æ…‹ã€æˆªæ­¢ã€ä¸‹ä¸€æ­¥å‹•ä½œ", score:5},
          {text:"ç”¨è…¦è¨˜ï¼Œé‡è¦çš„æ‰è¨˜éŒ„", score:2},
          {text:"å…¨éƒ¨å¯«åœ¨å‚™å¿˜éŒ„ä½†ä¸åˆ†é¡", score:3},
          {text:"ç­‰åˆ¥äººæé†’å†åš", score:1}
        ]
      },
      {
        id:"E6",
        title:"æƒ…å¢ƒï¼šå¡åœ¨ç­‰å¾…åˆ¥äººå›è¦†",
        desc:"ä½ çš„ä»»å‹™å¡åœ¨ç­‰å¾…ä»–äººå›è¦†ã€‚ä½ æœƒï¼Ÿ",
        dim:"å”ä½œæ¨é€²",
        options:[
          {text:"è¨­å®šå›è¦†æœŸé™ + æä¾›å¯é¸æ–¹æ¡ˆï¼Œé™ä½å°æ–¹æ±ºç­–æˆæœ¬", score:5},
          {text:"æ¯å¤©æé†’ä¸€æ¬¡ï¼Œçœ‹èª°å…ˆå›", score:3},
          {text:"ä¸æé†’ï¼Œæ€•æ‰“æ“¾", score:2},
          {text:"ç›´æ¥è‡ªå·±æ±ºå®šï¼Œä¹‹å¾Œå†èªª", score:2}
        ]
      },
      {
        id:"E7",
        title:"æƒ…å¢ƒï¼šéœ€æ±‚è®Šæ›´ä¸å¯é¿å…",
        desc:"éœ€æ±‚è®Šæ›´å¾ˆå¸¸ç™¼ç”Ÿï¼Œä½ è¦æ€éº¼ç¢ºä¿ä¸å¤±æ§ï¼Ÿ",
        dim:"è®Šæ›´ç®¡ç†",
        options:[
          {text:"å»ºç«‹è®Šæ›´æµç¨‹ï¼šå½±éŸ¿è©•ä¼°â†’å–æ¨æ±ºç­–â†’æ›´æ–°é‡Œç¨‹ç¢‘", score:5},
          {text:"å…ˆæ”¹å†èªªï¼Œåæ­£ç¸½æ˜¯è¦æ”¹", score:2},
          {text:"ä¸€å¾‹æ‹’çµ•è®Šæ›´", score:2},
          {text:"çœ‹å¿ƒæƒ…æ±ºå®šè¦ä¸è¦æ”¹", score:1}
        ]
      },
      {
        id:"E8",
        title:"æƒ…å¢ƒï¼šä½ è¦è®“æˆæœå¯è¤‡è£½",
        desc:"ä½ åšå¾—å¾ˆå¿«ï¼Œä½†åŒäº‹ç„¡æ³•è¤‡è£½ä½ çš„åšæ³•ã€‚ä½ æœƒï¼Ÿ",
        dim:"å¯è¤‡è£½æ€§",
        options:[
          {text:"æŠŠæµç¨‹å¯«æˆ 1 é  SOPï¼šè¼¸å…¥â†’æ­¥é©Ÿâ†’è¼¸å‡ºâ†’æª¢æŸ¥é»", score:5},
          {text:"å£é ­è¬›ä¸€æ¬¡å°±å¥½", score:3},
          {text:"è¦ºå¾—æ¯æ¬¡éƒ½ä¸ä¸€æ¨£ï¼Œæ²’æ³•å¯«", score:2},
          {text:"ä¸æƒ³åˆ†äº«ï¼Œé¿å…è¢«å–ä»£", score:1}
        ]
      }
    ]
  },

  "å•é¡Œè§£æ±º": {
    hint: "èšç„¦ï¼šå®šç¾©å•é¡Œã€æå‡ºå‡è¨­ã€é©—è­‰èˆ‡æ±ºç­–ã€‚",
    questions: [
      {
        id:"P1",
        title:"æƒ…å¢ƒï¼šæ•¸æ“šçªç„¶ä¸‹æ»‘ä½†åŸå› ä¸æ˜",
        desc:"æŒ‡æ¨™çªç„¶ä¸‹æ»‘ï¼Œä½†åŸå› ä¸æ˜ã€‚ä½ æœƒå¦‚ä½•é–‹å§‹æ’æŸ¥ï¼Ÿ",
        dim:"å•é¡Œå®šç¾©",
        options:[
          {text:"å…ˆå®šç¾©å•é¡Œèˆ‡å½±éŸ¿ç¯„åœï¼Œåˆ—å‡è¨­ï¼Œå¿«é€Ÿé©—è­‰æœ€å¯èƒ½çš„ 2â€“3 å€‹åŸå› ", score:5},
          {text:"å…ˆæ‰¾ç†Ÿæ‚‰çš„äººå•å•çœ‹å¤§æ¦‚æ˜¯ä»€éº¼åŸå› ", score:3},
          {text:"å…ˆç­‰çœ‹çœ‹ï¼Œå¯èƒ½éå¹¾å¤©æœƒæ¢å¾©", score:1},
          {text:"ç›´æ¥å¤§æ”¹ç­–ç•¥ï¼Œåæ­£åŸæœ¬ä¹Ÿè©²èª¿æ•´", score:2}
        ]
      },
      {
        id:"P2",
        title:"æƒ…å¢ƒï¼šå¤§å®¶å°å•é¡Œè¬›æ³•ä¸åŒ",
        desc:"æ¯å€‹äººéƒ½ç”¨è‡ªå·±çš„è§’åº¦æè¿°å•é¡Œï¼Œè¨è«–è¶Šä¾†è¶Šæ•£ã€‚ä½ æœƒï¼Ÿ",
        dim:"å°é½Šæ¡†æ¶",
        options:[
          {text:"å…ˆçµ±ä¸€å®šç¾©ï¼šç¾è±¡/ç›®æ¨™/é™åˆ¶/è¡¡é‡æ–¹å¼ï¼Œè®“å¤§å®¶åŒä¸€å¼µåœ–èªªè©±", score:5},
          {text:"å…ˆè®“å¤§å®¶è¬›å®Œï¼Œå†çœ‹èƒ½ä¸èƒ½æ‹¼å‡ºçµè«–", score:3},
          {text:"ç›´æ¥é¸ä½ è¦ºå¾—å°çš„èªªæ³•", score:2},
          {text:"é¿å…ä»‹å…¥ï¼Œè®“ä»–å€‘è‡ªå·±åµå‡ºçµæœ", score:1}
        ]
      },
      {
        id:"P3",
        title:"æƒ…å¢ƒï¼šæ ¹å› çœ‹èµ·ä¾†å¾ˆå¤š",
        desc:"ä½ åˆ—å‡ºå¾ˆå¤šå¯èƒ½åŸå› ï¼Œæ™‚é–“æœ‰é™ã€‚ä½ æœƒæ€éº¼æ’åºï¼Ÿ",
        dim:"å‡è¨­æ’åº",
        options:[
          {text:"ä¾å½±éŸ¿Ã—å¯èƒ½æ€§Ã—é©—è­‰æˆæœ¬æ’åºï¼Œå…ˆæ¸¬æœ€åˆ’ç®—çš„å‡è¨­", score:5},
          {text:"å…ˆæ¸¬æœ€å®¹æ˜“çš„ï¼Œåæ­£å…ˆåšå†èªª", score:3},
          {text:"å…ˆæ¸¬æœ€ä¸å¯èƒ½çš„ï¼Œæ’é™¤æ³•æ¯”è¼ƒå®‰å¿ƒ", score:2},
          {text:"å…ˆæŠŠæ‰€æœ‰å‡è¨­éƒ½ç ”ç©¶ä¸€éå†æ±ºå®š", score:2}
        ]
      },
      {
        id:"P4",
        title:"æƒ…å¢ƒï¼šéœ€è¦åšæ±ºç­–ä½†è³‡è¨Šä¸å®Œæ•´",
        desc:"ä½ å¿…é ˆåœ¨è³‡è¨Šä¸å®Œæ•´ä¸‹åšæ±ºç­–ã€‚ä½ æœƒï¼Ÿ",
        dim:"æ±ºç­–å“è³ª",
        options:[
          {text:"å…ˆåˆ—é¢¨éšªèˆ‡ä¸å¯é€†é»ï¼Œé¸ä¸€å€‹å¯å›é€€çš„æ–¹æ¡ˆä¸¦è¨‚è§€æ¸¬æŒ‡æ¨™", score:5},
          {text:"ç­‰è³‡è¨Šå®Œæ•´å†æ±ºç­–", score:2},
          {text:"æ†‘ç¶“é©—ç›´æ¥æ‹æ¿", score:3},
          {text:"è®“åˆ¥äººæ±ºå®šï¼Œé¿å…è²¬ä»»", score:1}
        ]
      },
      {
        id:"P5",
        title:"æƒ…å¢ƒï¼šæ¸¬è©¦çµæœä¸å¦‚é æœŸ",
        desc:"ä½ åšäº†ä¸€å€‹å°æ¸¬è©¦ï¼Œä½†çµæœæ²’æœ‰æ”¯æŒä½ çš„å‡è¨­ã€‚ä½ æœƒï¼Ÿ",
        dim:"è¿­ä»£å­¸ç¿’",
        options:[
          {text:"ä¿®æ­£å‡è¨­æˆ–æ¸¬è©¦è¨­è¨ˆï¼Œä¿ç•™å­¸åˆ°çš„è¨Šè™Ÿå†åšä¸‹ä¸€è¼ª", score:5},
          {text:"è¦ºå¾—æ¸¬è©¦ä¸æº–ï¼Œå¿½ç•¥çµæœ", score:2},
          {text:"ç«‹åˆ»æ›å¦ä¸€å€‹æ–¹å‘å¤§æ”¹", score:3},
          {text:"åœæ­¢å˜—è©¦ï¼Œç¶­æŒç¾ç‹€", score:1}
        ]
      },
      {
        id:"P6",
        title:"æƒ…å¢ƒï¼šå•é¡Œå…¶å¯¦æ˜¯æµç¨‹è€Œä¸æ˜¯äºº",
        desc:"ä½ æ‡·ç–‘å•é¡Œä¸æ˜¯æŸå€‹äººï¼Œè€Œæ˜¯æµç¨‹è¨­è¨ˆä¸è‰¯ã€‚ä½ æœƒï¼Ÿ",
        dim:"ç³»çµ±æ€ç¶­",
        options:[
          {text:"æ‰¾æµç¨‹ä¸­çš„ç“¶é ¸èˆ‡å›é¥‹å›è·¯ï¼Œç”¨å°æ”¹å‹•å…ˆé™ä½å¤±æ•—æ©Ÿç‡", score:5},
          {text:"å…ˆæ›äººåšçœ‹çœ‹", score:3},
          {text:"å…ˆè¦æ±‚å¤§å®¶æ›´åŠªåŠ›", score:2},
          {text:"è¦ºå¾—æ²’æ•‘ï¼Œåªèƒ½æ¥å—", score:1}
        ]
      },
      {
        id:"P7",
        title:"æƒ…å¢ƒï¼šè·¨éƒ¨é–€å„æœ‰ç«‹å ´",
        desc:"ä½ è¦è§£çš„å•é¡Œç‰½æ¶‰å¤šæ–¹åˆ©ç›Šï¼Œå®¹æ˜“äº’ç›¸æ¨è²¬ã€‚ä½ æœƒï¼Ÿ",
        dim:"åˆ©å®³å”èª¿",
        options:[
          {text:"æŠŠè¨è«–ç„¦é»æ‹‰å›å…±åŒç›®æ¨™èˆ‡è¡¡é‡æŒ‡æ¨™ï¼Œè®“å–æ¨é€æ˜åŒ–", score:5},
          {text:"å…ˆç§ä¸‹å„åˆ¥æºé€šï¼Œå†å›åˆ°æœƒè­°", score:3},
          {text:"ç›´æ¥è®“æœ€é«˜ä¸»ç®¡è£æ±º", score:3},
          {text:"ä¸ç¢°é€™ç¨®å•é¡Œï¼Œå¤ªéº»ç…©", score:1}
        ]
      },
      {
        id:"P8",
        title:"æƒ…å¢ƒï¼šéœ€è¦æŠŠå•é¡Œèªªæ¸…æ¥šçµ¦æ±ºç­–è€…",
        desc:"ä½ è¦å‘ä¸»ç®¡åŒ¯å ±å•é¡Œèˆ‡å»ºè­°ï¼Œä¸»ç®¡æ™‚é–“å¾ˆå°‘ã€‚ä½ æœƒï¼Ÿ",
        dim:"è¡¨é”çµæ§‹",
        options:[
          {text:"ç”¨ä¸€å¥è©±çµè«– + 3 é»è­‰æ“š + 1 å€‹å»ºè­°æ–¹æ¡ˆï¼ˆå«é¢¨éšªï¼‰", score:5},
          {text:"æŠŠå…¨éƒ¨ç´°ç¯€è¬›å®Œï¼Œé¿å…æ¼æ‰", score:2},
          {text:"å…ˆè¬›éç¨‹ï¼Œæœ€å¾Œå†è¬›çµè«–", score:3},
          {text:"ç­‰ä¸»ç®¡å•å†å›ç­”", score:2}
        ]
      }
    ]
  },

  "é ˜å°å¸¶äºº": {
    hint: "èšç„¦ï¼šæˆæ¬Šã€æ•™ç·´ã€å»ºç«‹è¦å‰‡èˆ‡åœ˜éšŠä¿¡ä»»ã€‚",
    questions: [
      {
        id:"L1",
        title:"æƒ…å¢ƒï¼šæ–°äººå¸¸å•é‡è¤‡å•é¡Œ",
        desc:"æ–°äººå¸¸å•é‡è¤‡å•é¡Œï¼Œå½±éŸ¿ä½ å·¥ä½œç¯€å¥ã€‚ä½ æœƒï¼Ÿ",
        dim:"æ•™ç·´å¸¶äºº",
        options:[
          {text:"å»ºç«‹ç°¡å–® SOP/FAQï¼Œå…ˆè®“æ–°äººè‡ªåŠ©ï¼Œå†ç´„å›ºå®šæ™‚é–“é›†ä¸­ç­”ç–‘", score:5},
          {text:"å…ˆå›è¦†ä»–ï¼Œä¹‹å¾Œå†èªª", score:3},
          {text:"å«ä»–è‡ªå·±å»å•åˆ¥äºº", score:2},
          {text:"è¦ºå¾—æ–°äººä¸è¡Œï¼Œé™ä½äº¤è¾¦", score:1}
        ]
      },
      {
        id:"L2",
        title:"æƒ…å¢ƒï¼šä½ éœ€è¦æˆæ¬Šä½†åˆæ€•å¤±æ§",
        desc:"ä½ æƒ³æˆæ¬Šçµ¦åŒäº‹ï¼Œä½†æ“”å¿ƒå“è³ªä¸ç©©ã€‚ä½ æœƒï¼Ÿ",
        dim:"æˆæ¬Šç®¡ç†",
        options:[
          {text:"å®šç¾©æ¸…æ¥šè¼¸å‡ºæ¨™æº–èˆ‡æª¢æŸ¥é»ï¼Œè®“åŒäº‹åœ¨æ¡†æ¶å…§è‡ªä¸»", score:5},
          {text:"å…ˆè‡ªå·±åšï¼Œæœ€å¿«ä¹Ÿæœ€ç©©", score:2},
          {text:"æˆæ¬Šå¾Œå®Œå…¨ä¸ç®¡ï¼Œç­‰çµæœ", score:2},
          {text:"åªæˆæ¬Šå¾ˆå°çš„äº‹æƒ…ï¼Œé‡è¦çš„è‡ªå·±åš", score:3}
        ]
      },
      {
        id:"L3",
        title:"æƒ…å¢ƒï¼šåŒäº‹ç¸¾æ•ˆä¸ç©©",
        desc:"åŒäº‹æœ‰æ™‚åšå¾—å¾ˆå¥½ï¼Œæœ‰æ™‚å¾ˆä¸ç©©å®šã€‚ä½ æœƒï¼Ÿ",
        dim:"ç¸¾æ•ˆè¼”å°",
        options:[
          {text:"æ‰¾å‡ºé—œéµæƒ…å¢ƒèˆ‡è¡Œç‚ºå·®ç•°ï¼Œè¨‚ 2 é€±æ”¹å–„ç›®æ¨™ä¸¦å›é¥‹è¿½è¹¤", score:5},
          {text:"å…ˆæé†’ä»–è¦æ›´èªçœŸ", score:2},
          {text:"ç›´æ¥æ›äººæˆ–èª¿æ•´å·¥ä½œå…§å®¹", score:3},
          {text:"æ”¾è‘—ä¸ç®¡ï¼Œç­‰ä»–è‡ªå·±æ”¹å–„", score:1}
        ]
      },
      {
        id:"L4",
        title:"æƒ…å¢ƒï¼šæœƒè­°æ•ˆç‡å¾ˆå·®",
        desc:"åœ˜éšŠæœƒè­°å¸¸ç™¼æ•£ã€æ™‚é–“æ‹‰é•·ã€æ²’æœ‰çµè«–ã€‚ä½ æœƒï¼Ÿ",
        dim:"ç¯€å¥èˆ‡è¦å‰‡",
        options:[
          {text:"è¨‚è­°ç¨‹/ç›®æ¨™/æ™‚é–“ç›’ï¼Œæœƒå¾Œè¼¸å‡ºæ±ºè­°èˆ‡ ownerï¼Œä¸‹ä¸€æ¬¡å…ˆå›é¡§", score:5},
          {text:"è®“å¤§å®¶è‡ªç”±è¨è«–ï¼Œç¸½æœƒæœ‰éˆæ„Ÿ", score:2},
          {text:"æ¸›å°‘æœƒè­°ï¼Œæ”¹ç”¨è¨Šæ¯æºé€š", score:3},
          {text:"æŠŠæœƒè­°äº¤çµ¦åˆ¥äººä¸»æŒ", score:2}
        ]
      },
      {
        id:"L5",
        title:"æƒ…å¢ƒï¼šåœ˜éšŠå‡ºç¾è¡çªæ´¾ç³»",
        desc:"åœ˜éšŠå‡ºç¾å°åœˆåœˆï¼Œäº’ç›¸ä¸ä¿¡ä»»ã€‚ä½ æœƒå…ˆåšï¼Ÿ",
        dim:"æ–‡åŒ–èˆ‡ä¿¡ä»»",
        options:[
          {text:"æŠŠè¡çªæ‹‰å›å…±åŒç›®æ¨™èˆ‡è¦å‰‡ï¼Œå®‰æ’çµå°åˆä½œå»ºç«‹å…±åŒå‹åˆ©", score:5},
          {text:"å„æ‰“äº”åå¤§æ¿ï¼Œè¦æ±‚å¤§å®¶å’Œå¹³", score:2},
          {text:"é¿å…ç¢°è¡çªï¼Œè®“æ™‚é–“è§£æ±º", score:1},
          {text:"å…ˆæ‰¾å¼·å‹¢çš„äººè«‡ï¼Œå£“ä½å±€é¢", score:3}
        ]
      },
      {
        id:"L6",
        title:"æƒ…å¢ƒï¼šä½ éœ€è¦çµ¦å›°é›£å›é¥‹",
        desc:"åŒäº‹åšæ³•æœ‰å•é¡Œï¼Œä½ å¿…é ˆçµ¦å›é¥‹ä½†æ€•å‚·å’Œæ°£ã€‚ä½ æœƒï¼Ÿ",
        dim:"å›é¥‹å°è©±",
        options:[
          {text:"ç”¨å…·é«”äº‹ä¾‹æè¿°å½±éŸ¿â†’æå‡ºæœŸå¾…â†’ç´„å®šä¸‹ä¸€æ¬¡æª¢æ ¸æ–¹å¼", score:5},
          {text:"ç”¨æš—ç¤ºæ–¹å¼æé†’ä¸€ä¸‹å°±å¥½", score:2},
          {text:"ç§ä¸‹åæ§½çµ¦å…¶ä»–åŒäº‹è½", score:1},
          {text:"ç­‰åˆ°æ›´åš´é‡å†èªª", score:2}
        ]
      },
      {
        id:"L7",
        title:"æƒ…å¢ƒï¼šåŒäº‹ç¼ºä¹ä¸»å‹•æ€§",
        desc:"åŒäº‹å¸¸ç­‰ä½ äº¤è¾¦ï¼Œç¼ºä¹ä¸»å‹•ã€‚ä½ æœƒï¼Ÿ",
        dim:"å‹•æ©Ÿèˆ‡æˆé•·",
        options:[
          {text:"èª¿æ•´ä»»å‹™è¨­è¨ˆï¼šè®“ä»–æœ‰æ±ºç­–ç©ºé–“ + æ¸…æ¥šè¡¡é‡æŒ‡æ¨™ï¼Œä¸¦è‚¯å®šæˆæœ", score:5},
          {text:"è¦æ±‚ä»–è¦æ›´ä¸»å‹•", score:2},
          {text:"æŠŠäº‹æƒ…æ”¶å›ä¾†è‡ªå·±åš", score:2},
          {text:"åªäº¤è¾¦å¾ˆå°çš„äº‹é¿å…å‡ºéŒ¯", score:3}
        ]
      },
      {
        id:"L8",
        title:"æƒ…å¢ƒï¼šä½ è¦å»ºç«‹å¯æŒçºŒçš„åœ˜éšŠèƒ½åŠ›",
        desc:"åœ˜éšŠèƒ½äº¤ä»˜ï¼Œä½†å“è³ªèˆ‡ç©©å®šåº¦ä¸ä¸€è‡´ã€‚ä½ è¦æ€éº¼åšï¼Ÿ",
        dim:"åˆ¶åº¦åŒ–",
        options:[
          {text:"å»ºç«‹æœ€å°åˆ¶åº¦ï¼šSOPã€æª¢æŸ¥è¡¨ã€å›é¡§ç¯€å¥ï¼ˆé€±/æœˆï¼‰ï¼ŒæŒçºŒè¿­ä»£", score:5},
          {text:"é è³‡æ·±åŒäº‹å¸¶æ–°äººå°±å¥½", score:3},
          {text:"é åŠ ç­æŠŠå“è³ªè£œå›ä¾†", score:2},
          {text:"è¦ºå¾—åˆ¶åº¦å¤ªéº»ç…©ï¼Œå…ˆæ”¾è‘—", score:1}
        ]
      }
    ]
  }
};

const PRESET_KEYS = Object.keys(QUESTION_BANK);

/** ======================================================
 *  State + Persistenceï¼ˆæ¯å€‹ä¸»é¡Œå„è‡ªä¿å­˜è‰ç¨¿ï¼‰
 * ====================================================== */
const STORAGE_PREFIX = "m9m12_demo_state_v2__";
const LAST_BANK_KEY = "m9m12_demo_last_bank_v2";

let state = {
  target: "",
  bankKey: "æºé€šå”ä½œ",
  prefs: { tone:"direct", focus:"action", role:"individual" },
  qIndex: 0,
  answers: {},     // QID -> score (null if unsure)
  unsureCount: 0,
  result: null
};

function storageKeyFor(bankKey){
  return STORAGE_PREFIX + encodeURIComponent(bankKey || "default");
}

function loadDraft(bankKey){
  try{
    const raw = localStorage.getItem(storageKeyFor(bankKey));
    if(!raw) return null;
    const obj = JSON.parse(raw);
    if(obj && typeof obj === "object") return obj;
  }catch(e){}
  return null;
}

function saveDraft(){
  try{
    localStorage.setItem(storageKeyFor(state.bankKey), JSON.stringify(state));
    localStorage.setItem(LAST_BANK_KEY, state.bankKey);
  }catch(e){}
}

function clearDraft(bankKey){
  try{
    localStorage.removeItem(storageKeyFor(bankKey));
  }catch(e){}
}

function setStateFromDraft(d){
  if(!d) return;
  // åªæ¥å—å·²çŸ¥æ¬„ä½ï¼Œé¿å…æ€ªè³‡æ–™
  state = {
    target: typeof d.target==="string" ? d.target : state.target,
    bankKey: typeof d.bankKey==="string" ? d.bankKey : state.bankKey,
    prefs: d.prefs && typeof d.prefs==="object" ? {...state.prefs, ...d.prefs} : state.prefs,
    qIndex: Number.isFinite(d.qIndex) ? d.qIndex : 0,
    answers: d.answers && typeof d.answers==="object" ? d.answers : {},
    unsureCount: Number.isFinite(d.unsureCount) ? d.unsureCount : 0,
    result: d.result && typeof d.result==="object" ? d.result : null
  };
}

/** ======================================================
 *  Bank / Target resolution
 * ====================================================== */
function normalize(s){
  return (s||"").toString().trim().replace(/\s+/g,"");
}

function resolveBankKey(input){
  const s = normalize(input);
  if(!s) return state.bankKey || "æºé€šå”ä½œ";

  // exact match
  for(const k of PRESET_KEYS){
    if(normalize(k) === s) return k;
  }
  // contains match (e.g. user types "å•é¡Œ" -> å•é¡Œè§£æ±º)
  for(const k of PRESET_KEYS){
    if(s.includes(normalize(k))) return k;
  }
  // keyword hints
  const map = [
    {keys:["æºé€š","å”ä½œ","å°é½Š","å…±è­˜","è·¨éƒ¨é–€"], bank:"æºé€šå”ä½œ"},
    {keys:["åŸ·è¡Œ","æ¨é€²","äº¤ä»˜","ç¯€å¥","é‡Œç¨‹ç¢‘","ä»»å‹™"], bank:"åŸ·è¡Œæ¨é€²"},
    {keys:["å•é¡Œ","åˆ†æ","å‡è¨­","é©—è­‰","æ ¹å› ","æ±ºç­–"], bank:"å•é¡Œè§£æ±º"},
    {keys:["é ˜å°","å¸¶äºº","æ•™ç·´","æˆæ¬Š","åœ˜éšŠ","ç®¡ç†"], bank:"é ˜å°å¸¶äºº"}
  ];
  for(const rule of map){
    if(rule.keys.some(kw => s.includes(normalize(kw)))) return rule.bank;
  }
  // fallback
  return "æºé€šå”ä½œ";
}

function currentBank(){
  return QUESTION_BANK[state.bankKey] || QUESTION_BANK["æºé€šå”ä½œ"];
}

function currentQuestions(){
  return currentBank().questions;
}

function currentDimsOrder(){
  // ä¾é¡Œç›®å‡ºç¾é †åºå»é‡ï¼›ä½ ä¹Ÿå¯ä»¥æ”¹æˆå›ºå®šæ’åº
  const seen = new Set();
  const dims = [];
  for(const q of currentQuestions()){
    if(!seen.has(q.dim)){
      seen.add(q.dim);
      dims.push(q.dim);
    }
  }
  return dims;
}

/** ======================================================
 *  View / UI helpers
 * ====================================================== */
const $ = (sel)=>document.querySelector(sel);
const $$ = (sel)=>Array.from(document.querySelectorAll(sel));

function show(viewId){
  $$(".view").forEach(v=>v.classList.remove("active"));
  $("#"+viewId).classList.add("active");
}

function setClock(){
  const d = new Date();
  const hh = String(d.getHours()).padStart(2,"0");
  const mm = String(d.getMinutes()).padStart(2,"0");
  $("#clock").textContent = `${hh}:${mm}`;
}

function starsHTML(n, max=5){
  let html="";
  for(let i=1;i<=max;i++){
    html += `
      <svg class="star ${i<=n?'on':''}" viewBox="0 0 24 24" aria-hidden="true">
        <path d="M12 2l2.9 6.3 6.9.6-5.2 4.5 1.6 6.7L12 16.9 5.8 20.1l1.6-6.7L2.2 8.9l6.9-.6L12 2z"/>
      </svg>`;
  }
  return html;
}

/** ======================================================
 *  Scoring (Hard-code)
 * ====================================================== */
function mapToStars(avgScore){
  if(avgScore >= 4.6) return 5;
  if(avgScore >= 3.8) return 4;
  if(avgScore >= 3.0) return 3;
  if(avgScore >= 2.2) return 2;
  return 1;
}

function computeResult(){
  const qs = currentQuestions();
  const dimsOrder = currentDimsOrder();

  const dimScores = {};
  const dimCounts = {};
  let total = 0, count = 0;

  qs.forEach(q=>{
    const v = state.answers[q.id];
    if(v == null) return;
    total += v; count += 1;
    dimScores[q.dim] = (dimScores[q.dim] || 0) + v;
    dimCounts[q.dim] = (dimCounts[q.dim] || 0) + 1;
  });

  const answered = count;
  const confidence = Math.max(0.35, Math.min(0.95, answered / qs.length));

  const dimStars = {};
  dimsOrder.forEach(d=>{
    if(dimCounts[d]){
      const avg = dimScores[d] / dimCounts[d];
      dimStars[d] = mapToStars(avg);
    }else{
      // æœªä½œç­”/æœªè¦†è“‹ï¼ˆæœ¬é¡Œåº«é€šå¸¸ä¸æœƒï¼‰
      dimStars[d] = 3;
    }
  });

  const overallAvg = answered ? total / answered : 3.0;
  const overallStars = mapToStars(overallAvg);

  const label = makeLabel(overallStars);
  const insights = makeInsights(dimStars, overallStars);
  const actionNow = makeActionNow(dimStars, state.prefs.focus);

  return {
    overallStars,
    overallAvg,
    label,
    dimStars,
    dimsOrder,
    confidence,
    answered,
    totalQ: qs.length,
    insights,
    actionNow
  };
}

function makeLabel(overallStars){
  if(overallStars >= 5) return "å¼·å‹¢ç©©å®šï½œå¯åšåœ˜éšŠæ¨™ç«¿";
  if(overallStars === 4) return "è¡¨ç¾è‰¯å¥½ï½œé€²ä¸€æ­¥è£œçŸ­æ¿";
  if(overallStars === 3) return "ä¸­ç­‰å¯ç”¨ï½œéœ€å»ºç«‹ä¸€è‡´æ–¹æ³•";
  if(overallStars === 2) return "é¢¨éšªåé«˜ï½œå…ˆä¿®æ­£é—œéµç¿’æ…£";
  return "éœ€å„ªå…ˆæ”¹å–„ï½œå»ºè­°é¡§å•ä»‹å…¥";
}

function makeInsights(dimStars, overallStars){
  const arr = Object.entries(dimStars).map(([k,v])=>({k,v}));
  arr.sort((a,b)=>b.v-a.v);
  const top = arr[0], low = arr[arr.length-1];

  const tone = state.prefs.tone;

  const t1 = tone==="direct"
    ? `å„ªå‹¢åœ¨ã€Œ${top.k}ã€ï¼šä½ é€šå¸¸èƒ½ç”¨æ›´æœ‰æ•ˆçš„æ–¹æ³•æ¨é€²ã€‚`
    : `ä½ çš„äº®é»æ˜¯ã€Œ${top.k}ã€ï¼šé€™æœƒæ˜¯ä½ æŒçºŒç´¯ç©ä¿¡ä»»çš„åŸºç¤ã€‚`;

  const t2 = tone==="direct"
    ? `çŸ­æ¿åœ¨ã€Œ${low.k}ã€ï¼šé€™æ˜¯é€ æˆå¡é—œ/é‡å·¥çš„ä¸»è¦é¢¨éšªé»ã€‚`
    : `å¯ä»¥å…ˆå¾ã€Œ${low.k}ã€è‘—æ‰‹ï¼šæŠŠé¢¨éšªé™ä¸‹ä¾†ï¼Œä½ æœƒæ›´çœåŠ›ã€‚`;

  const t3 = (overallStars>=4)
    ? `è‹¥ä½ è¦å‡ç´šåˆ°ã€Œå¯è¤‡è£½ã€çš„è¡¨ç¾ï¼šæŠŠåšæ³•å¯«æˆå° SOPï¼ˆ1é å°±å¤ ï¼‰ã€‚`
    : `å…ˆæŠŠã€Œä¸€ä»¶äº‹åšåˆ°å¯é æœŸã€ï¼šç”¨å›ºå®šæµç¨‹è™•ç† 1â€“2 å€‹é«˜é »å•é¡Œã€‚`;

  return [
    `æ´å¯Ÿ 1ï¼ˆå„ªå‹¢ï¼‰ï½œ${t1}`,
    `æ´å¯Ÿ 2ï¼ˆé¢¨éšªï¼‰ï½œ${t2}`,
    `æ´å¯Ÿ 3ï¼ˆå‡ç´šï¼‰ï½œ${t3}`
  ];
}

function makeActionNow(dimStars, focus){
  let lowDim = null, lowVal = 99;
  for(const [k,v] of Object.entries(dimStars)){
    if(v < lowVal){ lowVal = v; lowDim = k; }
  }

  const actionMap = {
    // æºé€šå”ä½œ
    "æºé€šæ¸…æ™°": "ä¸‹æ¬¡äº¤è¾¦å‰å…ˆå¯« 1 è¡Œã€Œç›®çš„/è¼¸å‡º/æˆªæ­¢æ™‚é–“ã€ï¼Œä¸¦é™„ä¸€å€‹ç¯„ä¾‹ã€‚",
    "å”ä½œæ¨é€²": "æŠŠéœ€æ±‚æ‹†æˆæœ€å°å¯äº¤ä»˜ç‰ˆæœ¬ï¼ˆMVPï¼‰ï¼Œç´„å®šã€èª°/åšä»€éº¼/ä½•æ™‚äº¤ä»˜ã€ã€‚",
    "å…±è­˜å°é½Š": "æœƒå¾Œ 3 åˆ†é˜æ•´ç†æ±ºè­°ï¼šowner/è¼¸å‡º/æˆªæ­¢ï¼Œè«‹å„æ–¹å›è¦†ç¢ºèªã€‚",
    "æå•æ¾„æ¸…": "æŠŠæ¨¡ç³Šå›é¥‹æ”¹æˆé¸æ“‡é¡Œï¼šæä¾› 2â€“3 å€‹æ–¹æ¡ˆè®“å°æ–¹é¸ã€‚",
    "å½±éŸ¿åŠ›": "ç”¨å°æ–¹é—œæ³¨çš„æŒ‡æ¨™ï¼ˆæˆæœ¬/é¢¨éšª/æ™‚ç¨‹ï¼‰é‡æ–°æè¿°ä½ çš„è¨´æ±‚ã€‚",
    "è¡çªè™•ç†": "æŠŠçˆ­é»æ”¹å¯«æˆã€å…±åŒç›®æ¨™ + å¯é©—è­‰å•é¡Œã€ï¼Œé¿å…æƒ…ç·’æ”»é˜²ã€‚",
    "å›é¥‹å¸æ”¶": "æ”¶åˆ°å›é¥‹å…ˆå•ï¼šå¯å¦çµ¦ä¸€å€‹ä¾‹å­ï¼Ÿä¸‹æ¬¡å¸Œæœ›æˆ‘æ€éº¼åšï¼Ÿ",
    "å”ä½œè¦å‰‡": "è¨‚è®Šæ›´æµç¨‹ï¼šæˆªæ­¢é»ã€å½±éŸ¿è©•ä¼°ã€èª°æ±ºç­–ï¼Œè®“æ”¹å‹•æœ‰ç¯€å¥ã€‚",

    // åŸ·è¡Œæ¨é€²
    "å„ªå…ˆé †åº": "åˆ—å‡ºæ‰‹ä¸Š 3 ä»¶äº‹çš„åƒ¹å€¼èˆ‡æˆªæ­¢æ™‚é–“ï¼Œè«‹å°æ–¹åšå–æ¨ï¼ˆä½ ä¸èƒŒé‹ï¼‰ã€‚",
    "æ‹†è§£è¦åŠƒ": "æŠŠä»»å‹™æ‹†æˆé‡Œç¨‹ç¢‘èˆ‡ MVPï¼Œå…ˆäº¤ä»˜å¯ç”¨ç‰ˆæœ¬å†è¿­ä»£ã€‚",
    "äº¤ä»˜ç­–ç•¥": "å…ˆäº¤ä»˜å¯ç”¨ç‰ˆæœ¬ï¼Œæ˜ç¢ºåˆ—å‡ºé¢¨éšªèˆ‡è£œé½Šæ™‚é–“é»ã€‚",
    "ç¯€å¥æ§åˆ¶": "æŠ“æœ€å¤§ç“¶é ¸ï¼Œè¨‚ã€æœ¬é€±å¿…é”ã€æœ€å°ç›®æ¨™ä¸¦æ¯å¤©è¿½ 1 æ¬¡ã€‚",
    "ä»»å‹™ç®¡ç†": "ç”¨ä¸€å€‹ç³»çµ±ç®¡ç†å¾…è¾¦ï¼šç‹€æ…‹/æˆªæ­¢/ä¸‹ä¸€æ­¥å‹•ä½œï¼ˆä¸è¦ç”¨è…¦è¨˜ï¼‰ã€‚",
    "è®Šæ›´ç®¡ç†": "æ¯æ¬¡è®Šæ›´éƒ½åšå½±éŸ¿è©•ä¼°â†’å–æ¨æ±ºç­–â†’æ›´æ–°é‡Œç¨‹ç¢‘ã€‚",
    "å¯è¤‡è£½æ€§": "æŠŠä½ çš„åšæ³•å¯«æˆ 1 é  SOPï¼šè¼¸å…¥â†’æ­¥é©Ÿâ†’è¼¸å‡ºâ†’æª¢æŸ¥é»ã€‚",

    // å•é¡Œè§£æ±º
    "å•é¡Œå®šç¾©": "å…ˆæŠŠå•é¡Œå¯«æˆä¸€å¥è©±ï¼šç¾è±¡/å½±éŸ¿/ç¯„åœ/è¦æ”¹å–„åˆ°å“ªè£¡ã€‚",
    "å°é½Šæ¡†æ¶": "ç”¨åŒä¸€å¥—æ¡†æ¶æè¿°ï¼šç¾è±¡â†’ç›®æ¨™â†’é™åˆ¶â†’è¡¡é‡ï¼Œé¿å…å„èªªå„è©±ã€‚",
    "å‡è¨­æ’åº": "ä¾å½±éŸ¿Ã—å¯èƒ½æ€§Ã—é©—è­‰æˆæœ¬æ’åºï¼Œå…ˆæ¸¬æœ€åˆ’ç®—çš„å‡è¨­ã€‚",
    "æ±ºç­–å“è³ª": "é¸å¯å›é€€æ–¹æ¡ˆï¼Œè¨‚è§€æ¸¬æŒ‡æ¨™èˆ‡åœæé»ã€‚",
    "è¿­ä»£å­¸ç¿’": "ä¿ç•™æ¸¬è©¦è¨Šè™Ÿï¼Œä¿®æ­£å‡è¨­æˆ–æ¸¬è©¦è¨­è¨ˆå†è·‘ä¸‹ä¸€è¼ªã€‚",
    "ç³»çµ±æ€ç¶­": "æ‰¾æµç¨‹ç“¶é ¸èˆ‡å›é¥‹å›è·¯ï¼Œç”¨å°æ”¹å‹•å…ˆé™å¤±æ•—ç‡ã€‚",
    "åˆ©å®³å”èª¿": "æŠŠå–æ¨é€æ˜åŒ–ï¼šå…±åŒç›®æ¨™ + æŒ‡æ¨™ + æ–¹æ¡ˆæ¯”è¼ƒã€‚",
    "è¡¨é”çµæ§‹": "ç”¨ 1 å¥çµè«– + 3 é»è­‰æ“š + 1 å€‹å»ºè­°æ–¹æ¡ˆï¼ˆå«é¢¨éšªï¼‰ã€‚",

    // é ˜å°å¸¶äºº
    "æ•™ç·´å¸¶äºº": "å»ºç«‹ 1 é  FAQï¼šæ–°äººå…ˆè‡ªåŠ©ï¼Œå›ºå®šæ™‚é–“é›†ä¸­ç­”ç–‘ã€‚",
    "æˆæ¬Šç®¡ç†": "å®šè¼¸å‡ºæ¨™æº– + æª¢æŸ¥é»ï¼Œè®“åŒäº‹åœ¨æ¡†æ¶å…§è‡ªä¸»ã€‚",
    "ç¸¾æ•ˆè¼”å°": "è¨‚ 2 é€±æ”¹å–„ç›®æ¨™èˆ‡å›é¥‹ç¯€å¥ï¼Œç”¨ä¾‹å­èªªå½±éŸ¿ã€‚",
    "ç¯€å¥èˆ‡è¦å‰‡": "æœƒè­°æ™‚é–“ç›’ + æœƒå¾Œæ±ºè­°è¼¸å‡ºï¼ˆowner/æˆªæ­¢/æª¢æ ¸ï¼‰ã€‚",
    "æ–‡åŒ–èˆ‡ä¿¡ä»»": "æ‹‰å›å…±åŒç›®æ¨™èˆ‡è¦å‰‡ï¼Œå®‰æ’çµå°åˆä½œå»ºç«‹å…±åŒå‹åˆ©ã€‚",
    "å›é¥‹å°è©±": "ç”¨å…·é«”ä¾‹å­â†’å½±éŸ¿â†’æœŸå¾…â†’ä¸‹ä¸€æ¬¡æª¢æ ¸æ–¹å¼ã€‚",
    "å‹•æ©Ÿèˆ‡æˆé•·": "çµ¦æ±ºç­–ç©ºé–“ + æ¸…æ¥šæŒ‡æ¨™ï¼Œä¸¦è‚¯å®šæˆæœå½¢æˆæ­£å›é¥‹ã€‚",
    "åˆ¶åº¦åŒ–": "å»ºç«‹æœ€å°åˆ¶åº¦ï¼šSOPã€æª¢æŸ¥è¡¨ã€å›é¡§ç¯€å¥ï¼ˆé€±/æœˆï¼‰ã€‚"
  };

  if(focus==="strategy"){
    return "æŠŠä½ æœ€å¸¸é‡åˆ°çš„å¡é»å¯«æˆã€æƒ…å¢ƒâ†’ç›®æ¨™â†’åšæ³•â†’è¡¡é‡ã€å››æ ¼ï¼Œç•¶ä½œä½ çš„å°æ–¹æ³•è«–ã€‚";
  }
  return actionMap[lowDim] || "é¸ä¸€å€‹ä½ æœ€å¸¸å¡é—œçš„æƒ…å¢ƒï¼Œå¯«ä¸‹ã€ä¸‹ä¸€æ¬¡æˆ‘æœƒæ€éº¼åšã€ã€‚";
}

/** ======================================================
 *  Render functions
 * ====================================================== */
function renderPresetChips(){
  const box = $("#presetChips");
  box.innerHTML = "";
  PRESET_KEYS.forEach(k=>{
    const el = document.createElement("div");
    el.className = "chip";
    el.textContent = k;
    el.onclick = ()=>{
      $("#targetInput").value = k;
      // åªæ¨™ç¤º UIï¼Œä¸ç«‹åˆ»åˆ‡é¡Œåº«ï¼ˆç”±ä¸‹ä¸€æ­¥æ±ºå®šï¼‰
      $$("#presetChips .chip").forEach(x=>x.classList.remove("active"));
      el.classList.add("active");
    };
    box.appendChild(el);
  });
}

function renderOverview(){
  const b = currentBank();
  const qs = currentQuestions();

  $("#summaryTarget").textContent = state.bankKey;
  $("#summaryHint").textContent = b.hint || "";

  $("#summaryQCount").textContent = `${qs.length} é¡Œ`;

  const t = state.prefs.tone==="direct" ? "ç›´æ¥" : "æº«å’Œ";
  const f = state.prefs.focus==="action" ? "è¡Œå‹•" : "ç­–ç•¥";
  const r = state.prefs.role==="individual" ? "å€‹äºº" : (state.prefs.role==="manager" ? "ä¸»ç®¡" : "HR/é¡§å•");
  $("#summaryPrefs").textContent = `${r}ï½œ${t}ï½œå${f}`;
  $("#overviewTitle").textContent = `ã€Œ${state.bankKey}ã€ç›¤é»æ¦‚è¦½`;
}

function renderQuestion(){
  const qs = currentQuestions();
  const q = qs[state.qIndex];

  $("#qStep").textContent = `ç¬¬ ${state.qIndex+1} / ${qs.length} é¡Œ`;
  $("#qTitle").textContent = q.title;
  $("#qDesc").textContent = q.desc;

  const pct = (state.qIndex / qs.length) * 100;
  $("#qBar").style.width = `${Math.min(100, pct)}%`;

  const opts = $("#options");
  opts.innerHTML = "";
  q.options.forEach((o, idx)=>{
    const btn = document.createElement("button");
    btn.className = "option";
    btn.type = "button";
    btn.textContent = `${String.fromCharCode(65+idx)}. ${o.text}`;
    if(state.answers[q.id] === o.score) btn.classList.add("selected");
    btn.onclick = ()=>{
      state.answers[q.id] = o.score;
      saveDraft();
      btn.classList.add("selected");
      setTimeout(()=>nextQuestion(), 260);
    };
    opts.appendChild(btn);
  });
}

function renderConfirm(){
  const qs = currentQuestions();
  const answered = Object.values(state.answers).filter(v=>v!=null).length;
  $("#answeredCount").textContent = `${answered} / ${qs.length}`;
  $("#confirmTarget").textContent = state.bankKey || "â€”";
}

function renderResult(){
  const r = state.result;

  $("#overallNum").textContent = r.overallStars;
  $("#overallLabel").textContent = r.label;
  $("#overallStars").innerHTML = starsHTML(r.overallStars);

  $("#confidenceLine").textContent = `å¯ä¿¡åº¦ï¼š${Math.round(r.confidence*100)}%ï¼ˆå·²å›ç­” ${r.answered}/${r.totalQ}ï¼‰`;

  const dimList = $("#dimList");
  dimList.innerHTML = "";
  r.dimsOrder.forEach(d=>{
    const s = r.dimStars[d];
    const row = document.createElement("div");
    row.className = "dimRow";
    row.innerHTML = `
      <div class="dimName">${d}</div>
      <div class="dimStars">${starsHTML(s,5)}</div>
    `;
    dimList.appendChild(row);
  });

  const ins = $("#insights");
  ins.innerHTML = "";
  r.insights.forEach(text=>{
    const c = document.createElement("div");
    c.className = "card";
    c.style.padding = "12px";
    c.style.borderRadius = "16px";
    c.style.background = "linear-gradient(180deg, #FFFFFF, #F7FAFF)";
    c.innerHTML = `<div class="small">${text}</div>`;
    ins.appendChild(c);
  });

  $("#actionNow").textContent = r.actionNow;

  // full report placeholder content
  $("#fullTitle").textContent = `ã€Œ${state.bankKey}ã€å®Œæ•´ç‰ˆå ±å‘Š`;
  const t = state.prefs.tone==="direct" ? "ç›´æ¥" : "æº«å’Œ";
  const f = state.prefs.focus==="action" ? "è¡Œå‹•" : "ç­–ç•¥";
  $("#fullMeta").textContent = `æ¨¡å¼ï¼š${t}ï½œå${f}ï½œå¯ä¿¡åº¦ï¼š${Math.round(r.confidence*100)}%ï¼ˆå·²å›ç­” ${r.answered}/${r.totalQ}ï¼‰`;

  $("#fullA").textContent = "ä½ åœ¨å„å‘åº¦çš„æ˜Ÿç­‰åˆ†å¸ƒå¦‚æ‘˜è¦é æ‰€ç¤ºã€‚å»ºè­°å…ˆä¿®æ­£æœ€ä½åˆ†å‘åº¦ï¼Œå†æŠŠé«˜åˆ†å‘åº¦åšæˆå¯è¤‡è£½æµç¨‹ï¼ˆSOPï¼‰ã€‚";
  $("#fullB").textContent = "é«˜é »é¢¨éšªé€šå¸¸å‡ºç¾åœ¨ï¼šéœ€æ±‚ä¸æ¸…ã€å„ªå…ˆé †åºè¢«æ’å–®ç ´å£ã€è·¨éƒ¨é–€å›è¦†æ…¢ã€è¡çªå‡æº«é€ æˆé‡å·¥ã€‚";
  $("#fullC").innerHTML = [
    "1) æŠŠé«˜é »æƒ…å¢ƒå¯«æˆå›ºå®šæµç¨‹ï¼ˆ1é å°±å¤ ï¼‰ã€‚",
    "2) æ¯é€±åšä¸€æ¬¡å°å›é¡§ï¼šæœ¬é€±æœ€æœ‰æ•ˆçš„ä¸€ä»¶äº‹ã€æœ€éœ€è¦ä¿®æ­£çš„ä¸€ä»¶äº‹ã€‚",
    "3) å°æœ€ä½åˆ†å‘åº¦åšåˆ»æ„ç·´ç¿’ï¼šä¸€æ¬¡åªæ”¹ä¸€å€‹è¡Œç‚ºã€‚"
  ].join("<br/>");
  $("#fullD").innerHTML =
    "ç¬¬ 1 é€±ï¼šå»ºç«‹ 1 å€‹æœ€å¸¸ç”¨æ¨¡æ¿ï¼ˆäº¤è¾¦/å›å ±/æ±ºè­°ï¼‰ã€‚<br/>" +
    "ç¬¬ 2 é€±ï¼šæŒ‘ 1 å€‹çœŸå¯¦æ¡ˆä¾‹ï¼Œä¾æ¨¡æ¿åŸ·è¡Œä¸¦è¨˜éŒ„çµæœã€‚<br/>" +
    "ç¬¬ 3 é€±ï¼šé‡å°æœ€ä½åˆ†å‘åº¦åš 2 æ¬¡åˆ»æ„ç·´ç¿’ã€‚<br/>" +
    "ç¬¬ 4 é€±ï¼šç¸½çµæˆã€ä¸€é æ–¹æ³•è«–ã€ï¼Œå½¢æˆå¯è¤‡è£½åšæ³•ã€‚";
  $("#fullE").textContent = "æ­¤ Demo æ˜Ÿç­‰ç‚ºç¤ºæ„ï¼šä»¥é¡Œç›®åˆ†æ•¸å¹³å‡æ˜ å°„æ˜Ÿç­‰ï¼›å¯ä¿¡åº¦ä¾å·²å›ç­”æ¯”ä¾‹ä¼°ç®—ã€‚æ­£å¼ç‰ˆå¯æ¥é¡Œåº«/æ¬Šé‡/æ˜Ÿç­‰æ¡†æ¶ã€‚";
}

function setPrefActive(){
  $$(".chip.pref").forEach(el=>{
    const k = el.dataset.key;
    const v = el.dataset.val;
    el.classList.toggle("active", state.prefs[k] === v);
  });
}

/** ======================================================
 *  Flow control
 * ====================================================== */
function nextQuestion(){
  const qs = currentQuestions();
  if(state.qIndex < qs.length - 1){
    state.qIndex += 1;
    saveDraft();
    renderQuestion();
  }else{
    renderConfirm();
    show("v-s5");
  }
}

function prevQuestion(){
  if(state.qIndex > 0){
    state.qIndex -= 1;
    saveDraft();
    renderQuestion();
    show("v-s4");
  }else{
    show("v-s3");
  }
}

let loadingTimer1=null, loadingTimer2=null;

function startLoading(){
  show("v-s6");
  $("#lsBar1").style.width = "0%";
  $("#lsBar2").style.width = "0%";

  let p1=0, p2=0;
  loadingTimer1 = setInterval(()=>{
    p1 += 8;
    $("#lsBar1").style.width = `${Math.min(p1, 100)}%`;
    if(p1>=100){
      clearInterval(loadingTimer1);
      loadingTimer2 = setInterval(()=>{
        p2 += 10;
        $("#lsBar2").style.width = `${Math.min(p2, 100)}%`;
        if(p2>=100){
          clearInterval(loadingTimer2);
          state.result = computeResult();
          saveDraft();
          renderResult();
          show("v-s7");
        }
      }, 180);
    }
  }, 160);
}

function stopLoading(){
  if(loadingTimer1) clearInterval(loadingTimer1);
  if(loadingTimer2) clearInterval(loadingTimer2);
  loadingTimer1 = loadingTimer2 = null;
}

/** ======================================================
 *  Bank switching logicï¼ˆé‡é»ï¼‰
 *  - ä¾è¼¸å…¥/ä¸»é¡Œchips resolve bankKey
 *  - åˆ‡æ› bankKey æ™‚ï¼šè¼‰å…¥è©²ä¸»é¡Œçš„è‰ç¨¿ï¼›æ²’æœ‰å°±åˆå§‹åŒ–
 * ====================================================== */
function switchBankByInput(inputText){
  const resolved = resolveBankKey(inputText);
  if(!QUESTION_BANK[resolved]) return;

  // å¦‚æœæœ¬ä¾†å°±åŒä¸€å€‹ä¸»é¡Œï¼Œåªæ›´æ–° target æ–‡æœ¬
  if(state.bankKey === resolved){
    state.target = inputText || resolved;
    saveDraft();
    return;
  }

  // å…ˆå„²å­˜ç›®å‰ä¸»é¡Œè‰ç¨¿
  saveDraft();

  // åˆ‡åˆ°æ–°ä¸»é¡Œï¼šå„ªå…ˆè®€è‰ç¨¿
  const draft = loadDraft(resolved);
  if(draft){
    setStateFromDraft(draft);
  }else{
    // æ–°ä¸»é¡Œä¹¾æ·¨åˆå§‹åŒ–
    state = {
      target: inputText || resolved,
      bankKey: resolved,
      prefs: {...state.prefs}, // ä¿ç•™åå¥½
      qIndex: 0,
      answers: {},
      unsureCount: 0,
      result: null
    };
  }

  // ç¢ºä¿ bankKey æ­£ç¢º
  state.bankKey = resolved;
  if(!state.target) state.target = resolved;

  // æ›´æ–° last bank
  saveDraft();
}

/** ======================================================
 *  Event bindings
 * ====================================================== */
function bind(){
  // generic back
  $$(".back[data-back]").forEach(b=>{
    b.onclick = ()=> show(b.dataset.back);
  });

  $("#btnToOverview").onclick = ()=>{
    const v = $("#targetInput").value.trim();
    // åˆ‡æ›é¡Œåº«ï¼ˆé‡é»ï¼‰
    switchBankByInput(v);
    renderOverview();
    show("v-s3");
  };

  $("#advRow").onclick = ()=>{
    // å…ˆæŠŠè¼¸å…¥åŒæ­¥åˆ° state.targetï¼ˆä½†ä¸åˆ‡æ›ä¹Ÿå¯ï¼‰
    const v = $("#targetInput").value.trim();
    if(v) state.target = v;
    setPrefActive();
    show("v-s2");
  };

  // S2 preference chips
  $$(".chip.pref").forEach(ch=>{
    ch.onclick = ()=>{
      const k = ch.dataset.key;
      const v = ch.dataset.val;
      state.prefs[k] = v;
      saveDraft();
      setPrefActive();
    };
  });

  $("#btnToOverview2").onclick = ()=>{
    const v = $("#targetInput").value.trim();
    switchBankByInput(v);
    renderOverview();
    show("v-s3");
  };

  $("#btnToPrefs").onclick = ()=>{
    setPrefActive();
    show("v-s2");
  };

  $("#btnStart").onclick = ()=>{
    // å¦‚æœæ²’ç­”éï¼Œå¾ 0 é–‹å§‹ï¼›å¦‚æœæœ‰è‰ç¨¿ï¼Œå»¶çºŒè‰ç¨¿
    if(state.qIndex >= currentQuestions().length) state.qIndex = 0;
    saveDraft();
    renderQuestion();
    show("v-s4");
  };

  $("#btnBackQ").onclick = ()=> prevQuestion();

  $("#btnUnsure").onclick = ()=>{
    const q = currentQuestions()[state.qIndex];
    state.answers[q.id] = null;
    state.unsureCount += 1;
    saveDraft();
    setTimeout(()=>nextQuestion(), 200);
  };

  $("#btnGenerate").onclick = ()=>{
    stopLoading();
    startLoading();
  };

  $("#btnCancelLoading").onclick = ()=>{
    stopLoading();
    show("v-s5");
  };

  $("#btnSkipToResult").onclick = ()=>{
    stopLoading();
    state.result = computeResult();
    saveDraft();
    renderResult();
    show("v-s7");
  };

  $("#btnRestart").onclick = ()=>{
    if(confirm("è¦é‡æ–°é–‹å§‹å—ï¼Ÿï¼ˆåªæ¸…é™¤æœ¬ä¸»é¡Œå›ç­”ï¼‰")){
      state.qIndex = 0;
      state.answers = {};
      state.unsureCount = 0;
      state.result = null;
      saveDraft();
      renderOverview();
      show("v-s3");
    }
  };

  $("#btnResetAll").onclick = ()=>{
    if(confirm("è¦æ¸…é™¤ã€æ‰€æœ‰ä¸»é¡Œã€è‰ç¨¿/çµæœä¸¦å›åˆ°é¦–é å—ï¼Ÿ")){
      // æ¸…é™¤æ‰€æœ‰ä¸»é¡Œè‰ç¨¿
      PRESET_KEYS.forEach(k => clearDraft(k));
      localStorage.removeItem(LAST_BANK_KEY);

      // é‡ç½®
      state = {
        target:"",
        bankKey:"æºé€šå”ä½œ",
        prefs:{ tone:"direct", focus:"action", role:"individual" },
        qIndex:0,
        answers:{},
        unsureCount:0,
        result:null
      };
      $("#targetInput").value = "";
      $$("#presetChips .chip").forEach(x=>x.classList.remove("active"));
      renderOverview();
      show("v-s1");
    }
  };

  $("#btnFullReport").onclick = ()=> show("v-s8");
  $("#btnBackToSummary").onclick = ()=> show("v-s7");

  $("#btnShare").onclick = async ()=>{
    if(!state.result) return;
    const r = state.result;
    const dimsTxt = r.dimsOrder.map(d => `- ${d}ï¼š${r.dimStars[d]}â˜…`).join("\n");

    const text =
`æˆ‘çš„èƒ½åŠ›ç›¤é»çµæœï¼ˆBeta Demoï½œç„¡å¾Œç«¯ï¼‰
ä¸»é¡Œï¼š${state.bankKey}
ç¸½æ˜Ÿç­‰ï¼š${r.overallStars}â˜…
å¯ä¿¡åº¦ï¼š${Math.round(r.confidence*100)}%ï¼ˆå·²å›ç­” ${r.answered}/${r.totalQ}ï¼‰
ä¸€å¥è©±ï¼š${r.label}

å‘åº¦ï¼š
${dimsTxt}

æ´å¯Ÿï¼š
- ${r.insights[0]}
- ${r.insights[1]}
- ${r.insights[2]}

ç«‹å³è¡Œå‹•ï¼š${r.actionNow}`;

    try{
      await navigator.clipboard.writeText(text);
      alert("å·²è¤‡è£½åˆ°å‰ªè²¼ç°¿ï¼Œå¯è²¼åˆ° LINE/WeChat/Emailã€‚");
    }catch(e){
      alert("ä½ çš„ç€è¦½å™¨ä¸å…è¨±è‡ªå‹•è¤‡è£½ï¼Œè«‹æ‰‹å‹•è¤‡è£½ï¼š\n\n" + text);
    }
  };
}

/** ======================================================
 *  Boot
 * ====================================================== */
document.addEventListener("DOMContentLoaded", () => {
  setClock();
  setInterval(setClock, 10_000);

  // render chips
  renderPresetChips();

  // restore last bank
  const last = localStorage.getItem(LAST_BANK_KEY);
  const initBank = (last && QUESTION_BANK[last]) ? last : "æºé€šå”ä½œ";

  // load draft for last bank
  const draft = loadDraft(initBank);
  if(draft){
    setStateFromDraft(draft);
  }else{
    state.bankKey = initBank;
    state.target = initBank;
  }

  // sync input
  $("#targetInput").value = state.target || state.bankKey;

  // highlight chip
  $$("#presetChips .chip").forEach(ch=>{
    ch.classList.toggle("active", normalize(ch.textContent) === normalize(state.bankKey));
    ch.onclick = ()=>{
      $("#targetInput").value = ch.textContent;
      $$("#presetChips .chip").forEach(x=>x.classList.remove("active"));
      ch.classList.add("active");
    };
  });

  setPrefActive();
  renderOverview();
  bind();
});
</script>
</body>
</html>
